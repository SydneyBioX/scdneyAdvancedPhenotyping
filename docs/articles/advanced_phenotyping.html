<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Phenotyping in Single Cell Data Analysis • scdneyAdvancedPhenotyping</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Phenotyping in Single Cell Data Analysis">
<meta property="og:description" content="scdneyAdvancedPhenotyping">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scdneyAdvancedPhenotyping</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_phenotyping.html">Advanced Phenotyping in Single Cell Data Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SydneyBioX/scdneyAdvancedPhenotyping">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="advanced_phenotyping_files/header-attrs-2.11/header-attrs.js"></script><script src="advanced_phenotyping_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="advanced_phenotyping_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="advanced_phenotyping_files/datatables-binding-0.20/datatables.js"></script><script src="advanced_phenotyping_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="advanced_phenotyping_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="advanced_phenotyping_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="advanced_phenotyping_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="advanced_phenotyping_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="advanced_phenotyping_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Advanced Phenotyping in Single Cell Data Analysis</h1>
                        <h4 class="author">Yingxin Lin<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Hani Jieun Kim<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Carissa Chen<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SydneyBioX/scdneyAdvancedPhenotyping/blob/master/vignettes/advanced_phenotyping.Rmd"><code>vignettes/advanced_phenotyping.Rmd</code></a></small>
      <div class="hidden name"><code>advanced_phenotyping.Rmd</code></div>

    </div>

    
    
<!-- Teaching guide on Zoom  [Nov 29 Version] -->
<!--  -->
<!-- First data analysis session -->
<!-- Zoom coordinator [Adam] -->
<!-- Room on cloud access issues [Yue] -->
<!-- Room for R issues including ggplot [Carissa] -->
<!-- Room for foundational single cell analysis [Andy] -->
<!-- Second data analysis session -->
<!-- Zoom coordinator [Adam] -->
<!-- Room for R issues including ggplot [Yue / Carissa / Adam] -->
<!-- Room for building the trajectory - issue on Section 2.2/2.3 [Hani] -->
<!-- Third data analysis session -->
<!-- Zoom coordinator / Main room [Ellis] -->
<!-- Room for R debugging issues including ggplot [Yue / Carissa / Adam] -->
<!-- Breakout room 1 [Hani / Jean] -->
<!-- Expert room on [Yingxin / Pengyi] -->
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<div id="description" class="section level3">
<h3 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h3>
<p>Cellular phenotyping broadly refers to all procedures that aim to identify the identity and/or state of cells, as well as the relationship between cells. This workshop, “Advanced Cellular Phenotyping”, is the third workshop in the “Single cell data integrative analysis” workshop series. Here, we discusses challenges and analytical focus associated with cellular phenotyping. The overall <em>learning goals</em> of the workshop is to understand the two common approaches to phenotype the cell: trajectory analysis and cell-cell interaction. We will also discuss the general analytical strategies associated with phenotyping single cells and future perspectives.</p>
<br><br>
</div>
<div class="aimbox">
<div id="preparation-and-assumed-knowledge" class="section level3">
<h3 class="hasAnchor">
<a href="#preparation-and-assumed-knowledge" class="anchor"></a><span class="fa-stack fa"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-pencil-alt fa-stack-1x fa-inverse"></i></span> Preparation and assumed knowledge</h3>
<ul>
<li>Knowledge of R syntax</li>
<li>Basic knowledge in <a href="https://bioconductor.org/books/release/OSCA/index.html">single cell data analysis</a>
</li>
<li>Familiarity with the <a href="https://www.bioconductor.org/packages/release/bioc/vignettes/SingleCellExperiment/inst/doc/intro.html">SingleCellExperiment class</a>
</li>
<li>Familiarity with our previous workshop vignette on <a href="https://sydneybiox.github.io/BIS2019_SC/">Introduction to Single Cell RNA-seq Analysis</a>
</li>
<li>Relevant background reading for the workshop can be found in the links above.</li>
</ul>
</div>
<div id="learning-objectives" class="section level3">
<h3 class="hasAnchor">
<a href="#learning-objectives" class="anchor"></a><span class="fa-stack fa"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-location-arrow fa-stack-1x fa-inverse"></i></span> Learning objectives</h3>
<ul>
<li>describe various strategies for cellular phenotyping</li>
<li>identify different workflows to build trajectory including calculate pseudo-times</li>
<li>generate appropriate graphics to visualise the trajectories and expression of genes</li>
<li>understand the different trajectory characterisation approaches including differentially expressed genes across trajectories,</li>
<li>evaluate the single cell data to identify genes that distinguish trajectories and ligand-receptor interactions that distinguish cell types</li>
<li>[optional] identify cell-cell interactions in a single cell data and understand how cell-cell communication can be used to distinguish cell types</li>
</ul>
</div>
</div>
<p><br><br></p>
<!-- ### Pre-requisites -->
<!-- The workshop requires basic knowledge of the following topics: -->
<!-- * Knowledge of R syntax -->
<!-- * Basic knowledge in [single cell data analysis](https://bioconductor.org/books/release/OSCA/index.html) -->
<!-- * Familiarity with the [SingleCellExperiment class](https://www.bioconductor.org/packages/release/bioc/vignettes/SingleCellExperiment/inst/doc/intro.html) -->
<!-- * Familiarity with our previous workshop vignette on [Introduction to Single Cell RNA-seq Analysis](https://sydneybiox.github.io/BIS2019_SC/) -->
<!-- Relevant background reading for the workshop can be found in the links above. -->
<div id="time-outline" class="section level3">
<h3 class="hasAnchor">
<a href="#time-outline" class="anchor"></a>Time outline</h3>
<p>Structure of the 2-hour workshop:</p>
<table class="table">
<thead><tr class="header">
<th>Activity</th>
<th>Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Introduction</td>
<td>10m</td>
</tr>
<tr class="even">
<td>Building a trajectory</td>
<td>30m</td>
</tr>
<tr class="odd">
<td>Characterizing the trajectory</td>
<td>30m</td>
</tr>
<tr class="even">
<td>Assessing the trajectory</td>
<td>40m</td>
</tr>
<tr class="odd">
<td>Cell-cell communication</td>
<td>10m</td>
</tr>
<tr class="even">
<td>Concluding remarks</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h2>
<p>Many biological processes manifest as a continuum of dynamic changes and diverse cellular states. One of the major goals of single cell data analysis is to identify and characterize these cell types and states that are induced from external stimulation (such as environmental insults or perturbations), the spatial context, the point along the differentiation system in which a cell lies and more. Collectively, these biological, genetic and environmental factors contribute towards the diversity of the phenotypes we see among cells.</p>
<p>We define the process of phenotyping as any procedure that attempts to further characterize the identity and/or state of cells and the relationship between cells and is distinct from procedures relating to the pre-processing or clustering of the data. One of the most common and basic phenotyping procedure is cell type identification, which is a highly researched topic in single cell data analysis. We can further explore various characteristics of the cells by</p>
<ol style="list-style-type: decimal">
<li>investigating where a cell lies along a trajectory, if the data demonstrates a pseudo-temporally ordered state;</li>
<li>determining if there are multiple branches in the trajectory (which may associate with different cell type lineages);</li>
<li>if the previous is true, distinguishing if certain gene expression programs are associated with a certain trajectory through differential expression analysis or gene set enrichment studies; and lastly;</li>
<li>investigating if a certain signalling patterns can be observe between cell types. Collectively, these efforts contribute towards phenotyping the data and obtaining a more descriptive characterization of the data at hand.</li>
</ol>
<p>Thus, the question becomes how do we identify the diverse phenotypes? Whilst single cell data enables us to interrogate the heterogeneity among the phenotypes and tease out different and distinct states, a cell’s phenotype is the manifestation of a collective and integrated output of a set of molecules or networks that span across multiple modalities (transcriptome, genome, epigenome, and proteome etc). In this workshop, we begin to investigate this using single-cell transcriptomes, acknowledging at the same time that a single modality alone may not be sufficient to accurately pinpoint all the phenotypes present in the data.</p>
<p>In this workshop, we will demonstrate two different approaches to phenotyping, trajectory analysis and cell-cell communication, using a mouse scRNA-seq data profiling the hippocampus dataset from <a href="https://www.nature.com/articles/s41586-018-0414-6#additional-information">La Manno et al. (2018)</a>.</p>
</div>
<div id="loading-libraries-and-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-libraries-and-the-data" class="anchor"></a>2. Loading libraries and the data</h2>
<div id="load-libraries" class="section level3">
<h3 class="hasAnchor">
<a href="#load-libraries" class="anchor"></a>2.1 Load libraries</h3>
<p>First, let us load some of the libraries we will be using in this workshop.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/">scater</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Cepo</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">slingshot</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/">ggridges</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/hms-dbmi/UpSetR">UpSetR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://theislab.github.io/destiny/">destiny</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="loading-the-preprocessed-data" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-the-preprocessed-data" class="anchor"></a>2.2 Loading the preprocessed data</h3>
<p>We will use the mouse hippocampus scRNA-seq dataset from <a href="https://www.nature.com/articles/s41586-018-0414-6#additional-information">La Manno et al. (2018)</a>. We provide the processed version in this workshop, which is subsampled (12,935 cells) from the original data (18,213 cells). The sampled data contains cells from two post-natal time points (P0 and P5) and a total of 8 cell types. The original data can be access from GEO with the accession number GSE104323.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># code to load data </span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/data/sce_DentateGyrus_hippocampus.rds"</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></code></pre></div>
</div>
<div id="visualising-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#visualising-the-data" class="anchor"></a>2.3 Visualising the data</h3>
<p>We will visualise the data using four different dimensionality reduction approaches and color the individual data points (denoting single cells) by their cell type labels. Without much knowledge of the biological system, can you guess whether the data contains discrete or continuous cell types just by examining these plots?</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span><span class="op">(</span><span class="va">sce</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runDiffusionMap.html">runDiffusionMap</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"PCA"</span><span class="op">)</span> 
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotUMAP</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"UMAP"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotTSNE</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"TSNE"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotDiffusionMap</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Diffusion Map"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong></p>
<p>The visualisations in <em>Step 2.3</em> suggests the presence of a clear trajectory. Starting from the progenitor cells (neuroblasts; Nbl1 and Nbl2), there is bifurcation of the trajectory into the two major lineages: the dentate gyrus granule neurons (“granule”) and pyramidal neurons (“CA”).</p>
</div>
</div>
</div>
<div id="trajectory-inference-how-can-i-infer-the-trajectory-for-my-data" class="section level2">
<h2 class="hasAnchor">
<a href="#trajectory-inference-how-can-i-infer-the-trajectory-for-my-data" class="anchor"></a>3. Trajectory inference: How can I infer the trajectory for my data?</h2>
<p>This section contains two parts. The first part focuses on the four key steps of building a trajectory and the second part focuses on quality assessment of the build trajectory.</p>
<div id="four-key-steps-in-building-a-trajectory" class="section level3">
<h3 class="hasAnchor">
<a href="#four-key-steps-in-building-a-trajectory" class="anchor"></a>3.1 Four key steps in building a trajectory</h3>
<p><strong>Step 1: Feature selection</strong></p>
<p>One of the first step in building a trajectoryis to perform feature selection. Given the high dimensional nature of high throughput single cell data, oftentimes it is advantageous to select for genes that provide biologically relevant information and remove those that add noise to the data. There are many ways to perform feature selection in single cell data, reviewed <a href="add_link">here</a>.</p>
<p>In this workshop, we demonstrate feature selection using <a href="https://www.biorxiv.org/content/10.1101/2021.01.10.426138v1">differential stability</a> from <a href="https://github.com/PYangLab/Cepo">Cepo</a> to choose the top 100 cell identity genes for each cell type.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cepo</span> <span class="op">=</span> <span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Cepo/man/Cepo.html">Cepo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html">logcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, <span class="va">sce</span><span class="op">$</span><span class="va">ClusterName</span>, exprsPct <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="va">cepoGenes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu">Cepo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Cepo/man/topGenes.html">topGenes</a></span><span class="op">(</span><span class="va">cepo</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Step 2: Dimension reduction</strong></p>
<p>The code below demonstrate using Cepo selected genes to perform PCA.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runPCA.html">runPCA</a></span><span class="op">(</span><span class="va">sce</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, subset_row <span class="op">=</span> <span class="va">cepoGenes</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotPCA</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"643 Cepo genes"</span><span class="op">)</span> </code></pre></div>
<p>Similar to Step 2.3, there are different dimensionality reduction approaches and we illustrate another three additional ways to achieve the same purposes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runTSNE.html">runTSNE</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>
<span class="va">sce</span> <span class="op">=</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runDiffusionMap.html">runDiffusionMap</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotUMAP</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"643 Cepo genes"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotTSNE</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"643 Cepo genes"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html">plotDiffusionMap</a></span><span class="op">(</span><span class="va">sce</span>, colour_by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"643 Cepo genes"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong></p>
<p>Running the dimensionality reduction with the data subsetted for the differentially stable genes reveals (using a quick visual interpretation) a trajectory in the PCA space that is more consistent with those observed in UMAP, TSNE, and DM.</p>
</div>
<p><strong>Step 3/4: Creating a lineage structure and psuedo time inference</strong></p>
<p>Building the trajectory is to infer and construct the trajectory and steps 3 and 4 are often combined in one function in many methods. Development of trajectory inference methods is actively evolving, and the effectiveness of current trajectory inference tools for transcriptomics data has been extensively reviewed in <a href="https://www.nature.com/articles/s41587-019-0071-9">this benchmarking paper</a>.</p>
<p>In this workshop, we will run <em>slingshot</em> on UMAP reduced dimension space as an example, for which more details of the implementation can be found <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-018-4772-0">here</a>. The basic input of slingshot is</p>
<ul>
<li>the expression matrix (as an SCE object),</li>
<li>cell type labels, and</li>
<li>the coordinates for the reduced dimensions.</li>
</ul>
<p><em>Details:</em> Slingshot implements a two-stage procedure whereby in the first step it infers the global lineage structure using the multi-spanning tree (MST) and then infers the pseudo-time for cells along each lineage by fitting simultaneous “principal curves” across multiple lineages. When known, we can also assign the starting node/cell type (i.e., “Nbl1”).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slingshot_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingshot.html">slingshot</a></span><span class="op">(</span><span class="va">sce</span>, 
                            clusterLabels <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">ClusterName</span>,
                            reducedDim <span class="op">=</span> <span class="st">'UMAP'</span>,
                            start.clus <span class="op">=</span> <span class="st">"Nbl1"</span><span class="op">)</span></code></pre></div>
</div>
<div id="visualisation-of-the-trajectory" class="section level3">
<h3 class="hasAnchor">
<a href="#visualisation-of-the-trajectory" class="anchor"></a>3.2 Visualisation of the trajectory</h3>
<div id="a-visualisation-with-base-r" class="section level4">
<h4 class="hasAnchor">
<a href="#a-visualisation-with-base-r" class="anchor"></a>(a) Visualisation with base R</h4>
<p>Let us visualise the slingshot results using the <em>base R</em></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span><span class="op">(</span><span class="va">slingshot_umap</span>, <span class="st">"UMAP"</span><span class="op">)</span>
<span class="va">plotcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/tableau_color_pal.html">tableau_color_pal</a></span><span class="op">(</span><span class="st">"Classic 10"</span><span class="op">)</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">$</span><span class="va">ClusterName</span><span class="op">)</span><span class="op">]</span>

<span class="co"># set the aspect ratio for base R plot as 1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">rd</span>, col <span class="op">=</span> <span class="va">plotcol</span>, 
     pch <span class="op">=</span> <span class="fl">16</span>, asp <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"UMAP1"</span>, ylab <span class="op">=</span> <span class="st">"UMAP2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/SlingshotDataSet.html">SlingshotDataSet</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">'black'</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="b-visualisation-the-same-results-using-ggplot2-" class="section level4">
<h4 class="hasAnchor">
<a href="#b-visualisation-the-same-results-using-ggplot2-" class="anchor"></a>(b) Visualisation the same results using <code>ggplot2</code>.</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_toPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>UMAP1 <span class="op">=</span> <span class="va">rd</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,
                        UMAP2 <span class="op">=</span> <span class="va">rd</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,
                        ClusterName <span class="op">=</span> <span class="va">slingshot_umap</span><span class="op">$</span><span class="va">ClusterName</span><span class="op">)</span>
<span class="va">pseudotime_umap</span> <span class="op">&lt;-</span> <span class="fu">slingshot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingPseudotime.html">slingPseudotime</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span>
<span class="va">df_toPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df_toPlot</span>, <span class="va">pseudotime_umap</span><span class="op">)</span>

<span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingCurves.html">slingCurves</a></span><span class="op">(</span><span class="va">slingshot_umap</span>, as.df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_toPlot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, y <span class="op">=</span> <span class="va">UMAP2</span>, color <span class="op">=</span> <span class="va">ClusterName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">curves</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, group <span class="op">=</span> <span class="va">Lineage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_color_tableau</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Classic 10"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong> Note that as expected we can see a total of three lineages that has been identified by slingshot, and the first bifurcation occurs at the junction of <code>Nbl1</code> and <code>Nbl2</code> and a second bifurcation at <code>CA</code> to give three terminal cell types, <code>CA1-Sub</code>, <code>CA2-3-4</code>, and <code>Granule</code>.</p>
</div>
</div>
<div id="c-visualisation-the-inferred-pseudotimes" class="section level4">
<h4 class="hasAnchor">
<a href="#c-visualisation-the-inferred-pseudotimes" class="anchor"></a>(c) Visualisation the inferred pseudotimes</h4>
<p>A more interesting visualisation would be to see how the pseudotimes have been inferred for the individual branches. By using the <code><a href="https://rdrr.io/pkg/slingshot/man/slingPseudotime.html">slingshot::slingPseudotime</a></code> function, we can access the inferred pseudotimes for the individual cells for each of the lineages identified.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## visualising the psuedotime</span>
<span class="va">df_toPlot2</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df_toPlot</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UMAP1"</span>, <span class="st">"UMAP2"</span>, <span class="st">"ClusterName"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_toPlot2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UMAP1"</span>, <span class="st">"UMAP2"</span>, <span class="st">"ClusterName"</span>, <span class="st">"Lineages"</span>, <span class="st">"Pseudotime"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_toPlot2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, y <span class="op">=</span> <span class="va">UMAP2</span>, color <span class="op">=</span> <span class="va">Pseudotime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">curves</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, group <span class="op">=</span> <span class="va">Lineage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Lineages</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="d-visualisation-the-density-of-cells-along-the-pseudotime" class="section level4">
<h4 class="hasAnchor">
<a href="#d-visualisation-the-density-of-cells-along-the-pseudotime" class="anchor"></a>(d) Visualisation the density of cells along the pseudotime</h4>
<p>Using the frequency of cells identified along the above pseudotime, we can also visualise the density of cells for each cell type along the three lineages using the <code>geom_density_ridges2</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges2</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_toPlot2</span>, 
                       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pseudotime</span>, y <span class="op">=</span> <span class="va">ClusterName</span>, fill <span class="op">=</span> <span class="va">ClusterName</span><span class="op">)</span>, 
                       alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Classic 10"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Lineages</span><span class="op">)</span> </code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>For users wanting to explore alternative methods to build the trajectory, please refer to the <a href="https://dynverse.org/">dynverse framework</a>, which provides a uniform interface to run more than 50 trajectory inference methods.</p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong></p>
<ul>
<li>Do these orderings make sense given the cluster labels? Why?</li>
<li>Would specifying starting cluster (<code>start.clus</code>) or not impact our trajectory results?</li>
</ul>
</div>
</div>
</div>
<div id="is-my-trajectory-appropriate-or-sensible" class="section level3">
<h3 class="hasAnchor">
<a href="#is-my-trajectory-appropriate-or-sensible" class="anchor"></a>3.3 Is my trajectory appropriate or sensible?</h3>
<p>In this section, we will look at the critical thinking questions that a researcher will ask about the trajectory.</p>
<div id="a-how-does-the-choice-of-dimensionality-reduction-affect-the-trajectory-inference" class="section level4">
<h4 class="hasAnchor">
<a href="#a-how-does-the-choice-of-dimensionality-reduction-affect-the-trajectory-inference" class="anchor"></a>(a) How does the choice of dimensionality reduction affect the trajectory inference?</h4>
<p>There are several parameters that may affect the final inferred pseudotime, such as</p>
<ul>
<li>the selection of features,</li>
<li>the choice of dimensionality reduction technique,</li>
<li>the method of lineage inference etc.</li>
</ul>
<p>Whilst it is beyond the scope of this workshop, finding the most optimal parameters may be data specific and requires close inspection of the final pseudotime against expected and known biological knowledge.In this section, we illustrate we can begin this tuning process by running the above analysis using a different dimension reduction technique and visualize the results.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Perform Slingshot analysis using TSNE</span>
<span class="va">slingshot_tsne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingshot.html">slingshot</a></span><span class="op">(</span><span class="va">sce</span>, 
                            clusterLabels <span class="op">=</span> <span class="va">sce</span><span class="op">$</span><span class="va">ClusterName</span>,
                            reducedDim <span class="op">=</span> <span class="st">"TSNE"</span>,
                            start.clus <span class="op">=</span> <span class="st">"Nbl1"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd_tsne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span><span class="op">(</span><span class="va">slingshot_tsne</span>, <span class="st">"TSNE"</span><span class="op">)</span>
<span class="va">df_toPlot</span><span class="op">$</span><span class="va">TSNE1</span> <span class="op">&lt;-</span> <span class="va">rd_tsne</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>
<span class="va">df_toPlot</span><span class="op">$</span><span class="va">TSNE2</span> <span class="op">&lt;-</span> <span class="va">rd_tsne</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>
<span class="va">curves_tsne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingCurves.html">slingCurves</a></span><span class="op">(</span><span class="va">slingshot_tsne</span>, as.df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">pseudotime_tsne</span> <span class="op">&lt;-</span> <span class="fu">slingshot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/slingshot/man/slingPseudotime.html">slingPseudotime</a></span><span class="op">(</span><span class="va">slingshot_tsne</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_toPlot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TSNE1</span>, y <span class="op">=</span> <span class="va">TSNE2</span>, color <span class="op">=</span> <span class="va">ClusterName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">curves_tsne</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">Dim.2</span>, group <span class="op">=</span> <span class="va">Lineage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_color_tableau</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Classic 10"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong></p>
<p>We can see that the resulting trajectory is similar to before and we are able to identify three distinct lineages. By generating a <strong>scatter plot</strong> of the correlation between the inferred pseudotime values, we can see that the trajectories the built based on UMAP and tSNE reduced dimension space are highly correlated with each other (cor &gt; 0.99). We illustrate the results for <code>Lineage 1</code>.</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pseudotime_tsne</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pseudotime_umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"Pseudotime from UMAP"</span>, xlab <span class="op">=</span> <span class="st">"Pseudotime from TSNE"</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">pseudotime_tsne</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">pseudotime_umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9967591</span></code></pre></div>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong></p>
<ul>
<li>As an additional exercise, would performing dimensionality reduction with a different set/number of selected features impact the trajectory results?</li>
</ul>
</div>
</div>
<div id="b-how-well-do-the-pseudotime-orderings-correlate-from-different-trajectory-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#b-how-well-do-the-pseudotime-orderings-correlate-from-different-trajectory-methods" class="anchor"></a>(b) How well do the pseudotime orderings correlate from different trajectory methods?</h4>
<p>As an example to illustrate the concordance between the results from running two different trajectory inference methods, here we will use <code>monocle3</code> to construct the trajectory on the same UMAP space and compare it against the results from <code>slingshot</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(monocle3)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Construt cell data set object for monocle3</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rowData</span>(sce) <span class="ot">&lt;-</span> <span class="fu">DataFrame</span>(<span class="fu">rowData</span>(sce), <span class="at">gene_short_name =</span> <span class="fu">rownames</span>(sce))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>cds <span class="ot">&lt;-</span> <span class="fu">as</span>(sce, <span class="st">"cell_data_set"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>cds <span class="ot">&lt;-</span> <span class="fu">cluster_cells</span>(cds, <span class="at">reduction_method =</span> <span class="st">"UMAP"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>cds <span class="ot">&lt;-</span> <span class="fu">learn_graph</span>(cds, <span class="at">use_partition =</span> <span class="cn">FALSE</span>) <span class="co"># set use_partition to FALSE so only a single graph is learnt</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cells</span>(cds,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color_cells_by =</span> <span class="st">"ClusterName"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label_groups_by_cluster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label_leaves =</span> <span class="cn">FALSE</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label_branch_points =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_tableau</span>(<span class="at">palette =</span> <span class="st">"Classic 10"</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<!-- <strong>Interpretation:</strong> -->
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong> Similar to the approach using <code>slingshot</code>, visualisation of the <code>monocle3</code> approach shows three distinct lineages, replicating two bifurcation points at <code>Nbl2</code> and <code>CA</code>.</p>
</div>
</div>
<div id="c-are-the-trajectory-methods-robust-to-the-choice-of-root-cells" class="section level4">
<h4 class="hasAnchor">
<a href="#c-are-the-trajectory-methods-robust-to-the-choice-of-root-cells" class="anchor"></a>(c) Are the trajectory methods robust to the choice of “root cells”?</h4>
<p>We can now calculate the pseudotimes. Note that it is important to set the cell type of origin (i.e., the cell type denoting the earliest temporal point of the differentiation when calculating pseudotimes. For <code>monocle3</code>, we will need to provide the <code>root_cells</code>, which requires us to specify a set of cells from the root cell type. By creating a customised function <code>get_earliest_principal_node</code> to do this, we can arbitrarily assign a set of cell from the cell type of origin as our <code>root_cells</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">get_earliest_principal_node</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cds</span>, <span class="va">coldata_name</span>, <span class="va">start.clust</span><span class="op">)</span><span class="op">{</span>
  <span class="va">cell_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">cds</span><span class="op">)</span><span class="op">[</span>, <span class="va">coldata_name</span><span class="op">]</span> <span class="op">==</span> <span class="va">start.clust</span><span class="op">)</span>
  <span class="va">closest_vertex</span> <span class="op">&lt;-</span> <span class="va">cds</span><span class="op">@</span><span class="va">principal_graph_aux</span><span class="op">[[</span><span class="st">"UMAP"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pr_graph_cell_proj_closest_vertex</span>
  <span class="va">closest_vertex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">closest_vertex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cds</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>
  <span class="va">root_pr_nodes</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="fu">principal_graph</span><span class="op">(</span><span class="va">cds</span><span class="op">)</span><span class="op">[[</span><span class="st">"UMAP"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">closest_vertex</span><span class="op">[</span><span class="va">cell_ids</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="va">root_pr_nodes</span>
<span class="op">}</span>

<span class="co"># Set the root cells</span>
<span class="va">root_cells</span> <span class="op">&lt;-</span> <span class="fu">get_earliest_principal_node</span><span class="op">(</span><span class="va">cds</span>, coldata_name <span class="op">=</span> <span class="st">"ClusterName"</span>,
                                          start.clust <span class="op">=</span> <span class="st">"Nbl1"</span><span class="op">)</span>
<span class="co"># Order the cells to calculate pseudotime</span>
<span class="va">cds</span> <span class="op">&lt;-</span> <span class="fu">order_cells</span><span class="op">(</span><span class="va">cds</span>, 
                   root_pr_nodes <span class="op">=</span> <span class="va">root_cells</span><span class="op">)</span>

<span class="fu">plot_cells</span><span class="op">(</span><span class="va">cds</span>,
           color_cells_by <span class="op">=</span> <span class="st">"pseudotime"</span>,
           label_cell_groups <span class="op">=</span> <span class="cn">FALSE</span>,
           label_leaves <span class="op">=</span> <span class="cn">FALSE</span>,
           label_branch_points <span class="op">=</span> <span class="cn">FALSE</span>,
           graph_label_size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">monocle3_pseudotime</span> <span class="op">&lt;-</span> <span class="va">cds</span><span class="op">@</span><span class="va">principal_graph_aux</span><span class="op">[[</span><span class="st">"UMAP"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pseudotime</span></code></pre></div>
<p>Again, we can evaluate the concordance in pseudotimes inferred across the two trajectory inference methods, <code>slingshot</code> and <code>monocle3</code>. Are you satisfied with the agreement?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">monocle3_pseudotime</span>, <span class="va">pseudotime_umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, xlab <span class="op">=</span> <span class="st">"Monocle 3"</span>, ylab <span class="op">=</span> <span class="st">"Slingshot (Lineage 1)"</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">monocle3_pseudotime</span>, <span class="va">pseudotime_umap</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9956697</span></code></pre></div>
<!-- Discussion -->
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong></p>
<ul>
<li>Can we use <code>order_cells</code> in <code>monocle3</code> if we do not know what the <code>root</code> cell type is?</li>
</ul>
</div>
</div>
</div>
<div id="extension-rna-velocity-vs-trajectory-pseudotime-inference-optional" class="section level3">
<h3 class="hasAnchor">
<a href="#extension-rna-velocity-vs-trajectory-pseudotime-inference-optional" class="anchor"></a>3.4 Extension: RNA velocity vs trajectory pseudotime inference [OPTIONAL]</h3>
<p>Example code for applying RNA velocity</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">velocyto.R</span><span class="op">)</span>
<span class="va">emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"spliced"</span><span class="op">)</span>
<span class="va">nmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assay</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"unspliced"</span><span class="op">)</span>
<span class="va">cluster.label</span> <span class="op">&lt;-</span> <span class="va">sce</span><span class="op">$</span><span class="va">ClusterName</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cluster.label</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>
<span class="co"># Use UMAP embeddings</span>
<span class="va">emb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"UMAP"</span><span class="op">)</span>
<span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"PCA"</span><span class="op">)</span>
<span class="co"># Calculate distance</span>
<span class="va">cell.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/armaCor.html">armaCor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">pca</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Filtering the genes</span>
<span class="va">emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/filter.genes.by.cluster.expression.html">filter.genes.by.cluster.expression</a></span><span class="op">(</span><span class="va">emat</span>, <span class="va">cluster.label</span>, min.max.cluster.average <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">nmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/filter.genes.by.cluster.expression.html">filter.genes.by.cluster.expression</a></span><span class="op">(</span><span class="va">nmat</span>, <span class="va">cluster.label</span>, min.max.cluster.average <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co"># Using 3838 genes for velocity estimation</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">emat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">emat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 3838</span>

<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"~/output/velocyto_res.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">rvel.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/gene.relative.velocity.estimates.html">gene.relative.velocity.estimates</a></span><span class="op">(</span><span class="va">emat</span>, <span class="va">nmat</span>, deltaT <span class="op">=</span> <span class="fl">1</span>,
                                              kCells <span class="op">=</span> <span class="fl">20</span>, cell.dist <span class="op">=</span> <span class="va">cell.dist</span>,
                                              fit.quantile <span class="op">=</span> <span class="fl">0.02</span>, n.cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">rvel.cd</span>, file <span class="op">=</span> <span class="st">"~/output/velocyto_res.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">rvel.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/output/velocyto_res.rds"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plotcol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/tableau_color_pal.html">tableau_color_pal</a></span><span class="op">(</span><span class="st">"Classic 10"</span><span class="op">)</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cluster.label</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">plotcol</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">cluster.label</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pty <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"figures/velocity.pdf"</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/show.velocity.on.embedding.cor.html">show.velocity.on.embedding.cor</a></span><span class="op">(</span><span class="va">emb</span>, <span class="va">rvel.cd</span>, n <span class="op">=</span> <span class="fl">300</span>, scale <span class="op">=</span> <span class="st">'sqrt'</span>,
                               cell.colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/velocyto.R/man/ac.html">ac</a></span><span class="op">(</span><span class="va">plotcol</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>, 
                               cex <span class="op">=</span> <span class="fl">0.8</span>, arrow.scale <span class="op">=</span> <span class="fl">5</span>, show.grid.flow <span class="op">=</span> <span class="cn">TRUE</span>,
                               min.grid.cell.mass <span class="op">=</span> <span class="fl">0.5</span>, grid.n <span class="op">=</span> <span class="fl">40</span>,
                               arrow.lwd <span class="op">=</span> <span class="fl">1</span>, do.par <span class="op">=</span> <span class="cn">F</span>, cell.border.alpha <span class="op">=</span> <span class="fl">0.1</span>,
                               return.details <span class="op">=</span> <span class="cn">TRUE</span>,
                               n.cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><embed src="figures/velocity.pdf"></embed></p>
<!-- Discussion -->
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong></p>
<ul>
<li>What is the distinction between RNA velocity and other types of trajectory pseudotime inference, and do they address the same questions?</li>
</ul>
</div>
</div>
</div>
<div id="how-can-i-characterise-the-trajectory-of-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#how-can-i-characterise-the-trajectory-of-the-data" class="anchor"></a>4. How can I characterise the trajectory of the data?</h2>
<p>So far, we have built a trajectory from our mouse hippocampus data using the transcriptomes of single cells. During this process, we determined the presence of three distinct lineages in the trajectory, observed two bifurcation events (or branching) in the data that was in line with the underlying biological system, and investigated the impact of using different dimensionality reduction techniques and different methods of trajectory inference.</p>
<p>We can now being to further phenotype the trajectories by investigating the changes in the specific gene expressions programs across and between lineages. We will ask the following questions:</p>
<ul>
<li>Within a lineage, which genes are differentially expressed across a pseudotime?</li>
<li>Which genes exhibit different patterns of gene expression across the pseudotime between lineages?</li>
<li>Can we group the genes in terms of their gene expression patterns across the pseudotime?</li>
<li>Are specific pathways or gene sets enriched in these gene groups?</li>
<li>Which gene-pair correlations change across lineages?</li>
</ul>
<div id="within-a-lineage-which-genes-are-differentially-expressed-across-a-pseudotime" class="section level3">
<h3 class="hasAnchor">
<a href="#within-a-lineage-which-genes-are-differentially-expressed-across-a-pseudotime" class="anchor"></a>4.1 Within a lineage, which genes are differentially expressed across a pseudotime?</h3>
<p><strong>Background:</strong> A suitable statistical model for determining which gene expression is related to pseudotime is the generalise additive model. A generalised additive model (GAM) in statistics is a generalised linear model in which the linear response variable is linearly dependent on unknown smooth functions of certain predictor variables. GAMs can be thought of as a bridge between simple linear models and advanced machine-learning techniques, allowing researchers to model non-linear data or more complex systems. In GAM, inference on smooth functions is frequently the main focus. The GAM model is typically written as <span class="math display">\[ y = \beta_0 + f(t) + \epsilon; \epsilon \sim N(0,\sigma^2)\]</span> where <span class="math inline">\(t\)</span> represent pseudotime estimated from Section 3.</p>
<p>The approach <code>tradeSeq</code> <a href="https://www.nature.com/articles/s41467-020-14766-3">Berge et al., 2020</a> implement a negative bionomial-GAM (NA-GAM) model to detect genes that are differentially expressed along one or multiple lineages in a trajectory. The NB-GAMS model can be fitted using the functions in <code>tradeSeq</code>. Here the choice of <strong>knot number</strong> is an important model parameters. This parameter specifies how complex the data expression patterns are, with a higher number of knots allowing for more intricate expression patterns. The most optimal choice of knots can be derived from using the <code>evaluteK</code> function. If your data contains many conditions, use the <code>conditions</code> option to fit individual smoothers for each condition.</p>
<p><strong>Computation:</strong> In the interest of time, we suggest performing this analysis using</p>
<pre><code>- the set of differentially stable genes (643 genes) derived earlier in this workshop; and
- set `knots = 6` when fitting the NB-GAM. </code></pre>
<p>This component is computationally intensive, and the ‘fitGAM’ process, as seen below, will take about ten minutes to complete. As an alternative, we recommend completing the rest of this tutorial with the prerun output and exploring this component as a post-workshop exercise.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://statomics.github.io/tradeSeq/index.html">tradeSeq</a></span><span class="op">)</span>
<span class="va">slingshot_umap</span> <span class="op">&lt;-</span> <span class="va">slingshot_umap</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"~/output/slingshot_umap.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">slingshot_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/fitGAM.html">fitGAM</a></span><span class="op">(</span><span class="va">slingshot_umap</span>,
                           genes <span class="op">=</span> <span class="va">cepoGenes</span>,
                           nknots <span class="op">=</span> <span class="fl">6</span>,
                           verbose <span class="op">=</span> <span class="cn">TRUE</span>,
                           parallel <span class="op">=</span> <span class="cn">FALSE</span>,
                           sce <span class="op">=</span> <span class="cn">TRUE</span>,
                           family <span class="op">=</span> <span class="st">"nb"</span>,
                           gcv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">slingshot_umap</span>, file <span class="op">=</span> <span class="st">"~/output/slingshot_umap.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">slingshot_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/output/slingshot_umap.rds"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">rowData</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span><span class="op">$</span><span class="va">tradeSeq</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; TRUE </span>
<span class="co">#&gt;  643</span></code></pre></div>
<p><strong>(a) Test for association</strong></p>
<p>Next, using the fitted gene expressions, we can assess for significant changes in gene expression (i.e., differential expression) as a function of pseudotime within each lineage using the <code>associationTest</code> function. Importantly, setting <code>lienages = TRUE</code> will specify that the differential expression analysis should be performed for each lineage separately, as well as performing the test across all lineages simultaneously. Here, we will only focus on perform the association test on the Cepo selected gene.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assoRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/associationTest.html">associationTest</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">[</span><span class="va">cepoGenes</span>, <span class="op">]</span>, global <span class="op">=</span> <span class="cn">TRUE</span>, lineages <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">assoRes</span> <span class="op">&lt;-</span> <span class="va">assoRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">assoRes</span><span class="op">$</span><span class="va">waldStat</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">assoRes</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatSignif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">assoRes</span>, <span class="va">is</span>, <span class="st">'numeric'</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f115de6daaf8a03bb699" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f115de6daaf8a03bb699">{"x":{"filter":"none","vertical":false,"data":[["Mdk","Lrp1b","Cntn5","Calb2","2810417H13Rik","Fam19a2","Chd7","Syt4","Cntnap5a","Tiam2","Cntnap5b","Grid2","Actr3b","Unc5c","Cdh11","Slc1a3","Vsnl1","Mgat4c","Cx3cl1","Nrip3","Gda","Ptk2b","Prox1","Hmgn2","Prkcg","Btbd3","Hells","Kcnip2","Sertm1","Rph3a","RP23-407N2.2","Fam163b","Phyhip","6330403A02Rik","Cntn4","Stat3","Ptprn","Lmo1","Rit2","Nhlh2","Plcl1","Lsm11","Dusp14","Rimbp2","Rrm2","Ano3","Icam5","Rasgef1b","Notch1","Il1rap","Clmp","Btbd17","Pax6","Mfng","Sulf2","Itpka","Crabp1","Adamts18","Baz1a","Pcdh1","Nt5dc2","Gng4","Gsap","Prom1","Kctd8","Adora1","Syt2","Iqsec3","Nts","Mcm5","Zfp36l1","Rbms1","L3mbtl4","Car10","Thrb","Vat1l","Ccdc184","Spon1","Adgrg1","Abca1","Rmi2","Adamts17","Sgk1","Mms22l","Nanos1","Gpd1","Tox","Gmnn","Ypel2","Ablim3","Neurod1","Clspn","Zmat4","Gas1","Cldn3","Mcm4","Shb","Fosl2","Eya1","Efnb2","Hs3st1","Fndc1","Sdk1","Kcne1l","Npy1r","Cdc42ep3","Fam131c","Fam159b","Zfp367","Tmem141","Chrna7","Dpy19l1","Vstm2b","Myo1b","Myh7","Zcchc24","Gab1","Ifitm10","Lypd6b","Tox2","Fam181b","D030025P21Rik","4930578M01Rik","Tbata","Rspo2","Inhbb","Gcnt2","Cdh20","Capn3","Arhgap6","Bcl2","Timp3","Plekhg2","Scgn","A730004F24Rik","3110002H16Rik","Rarb","Gm13703","Rnase4","Rpa2","Trpc7","Gm14964","Spats2l","Runx1t1","Grp","Hs6st2","6530403H02Rik","RP23-231J2.1","Cryab","Gm11417","Insm1","Tgfbr3","9530059O14Rik","Lypd6","Itgbl1","Tmem132c","Col11a1","Pdlim4","Tmem132cos","Xist","Fhl2","Kcnc2","Col12a1","Ppp2r1b","2900055J20Rik","Cdkn1c","Zfp462","Cpne4","Lmo7","Ak4","Arhgap28","Vim","Kctd16","Cntn2","Kcp","Pcdh7","Lancl3","Luzp2","Fzd7","Arhgef26","Sipa1l2","Rai2","Pvrl3","Adra2a","Msx3","Gm13944","Fez2","Acot1","Kcnmb2","Vat1","Fam163a","Ccdc109b","Antxr1","1190005I06Rik","Trps1","Pcdh19","Pex5l","Glipr2","Pde1a","Camk1d","Spock1","Palmd","Vcan","F13a1","Jakmip1","Tmem200c","Itpripl1","Bcl6b","Myc","Wscd1","Dok5","Cmtm3","Disc1","Gm11659","Rgs6","Pou3f1","Grin3a","Ldb2","Gm27247","Sla","Gm30382","Ndrg1","Mir124-2hg","Mpped1","Rprml","Avpr1a","Chst8","Sorcs3","RP24-236C17.2","Bcl6","Ntng1","Ldlrad4","Man1a","A230006K03Rik","Bmpr1b","Fbn2","Hcrtr2","Rgcc","Cntn3","Crim1","Nov","Klf6","Gm43507","Trpc4","Matn2","Cntn6","Tmtc4","Triqk","Nr4a2","Adgrl2","Gabra1","Csgalnact1","Flrt2","Pcsk2","Gabra3","Ntm","Agbl4","Masp1","Rspo3","Pls3","Efna3","Scube1","Mlip","Rnd1","Ank1","Ociad2","Xylt1","Adamts2","Npr3","Lpl","Akr1c19","Slc6a15","Galnt9","Gm1043","Epb41l4a","Rasl11b","Nat14","Asns","Krt1","Met","Etv1","Satb2","Nrsn1","Gpr22","Ptprt","Gm9866","Tmtc2","Adamtsl1","Nbl1","S100a10","Slit1","Klk8","Me1","Ccbe1","Trhde","Dkkl1","Gpr158","Raver2","Snhg11","Nptx1","Syt13","Nwd2","Prss35","Scn9a","Pfkp","Lxn","Slc6a7","Chodl","Adap1","1700001L19Rik","Scn1b","Trpm3","Slc17a7","Snx7","Fam19a1","Prrt2","Ptprr","Chst1","Ankrd29","Gatm","Cdkl2","Ube2ql1","Nos1","Pcnxl2","Hs3st4","S100a11","Lin7b","Nefm","Faah","Dlc1","Rasgef1a","Nebl","Ntsr2","Bves","Arhgef28","Cdk5r2","Popdc3","Cgref1","Cidea","Nefl","Slc26a4","Hebp1","Calb1","Dock10","C1ql3","AI593442","2010300C02Rik","Dgkg","Mal2","Myo5b","Spock3","Pla2g3","Il1rapl2","Adcy1","C1ql2","Kcnj4","Rasgrf1","Npnt","Ntf3","Tgfa","Ddn","Neto1","Gucy1a3","Htr4","Cpne6","Pkib","Syt17","Gm17455","Fstl4","Col25a1","Cdh13","Sowaha","Diras2","Col19a1","Grem2","Tuba4a","Ptchd4","Kcnip1","Dbpht2","Pde7b","Ildr2","Brinp1","Tmtc1","Chrm1","Rasgrf2","Cap2","Shisa9","Me3","Gm42722","Arhgap24","Cnnm1","Gm42477","Tmem114","Gucy1b3","Sidt1","Iqgap2","Bdnf","Kcna1","Tmcc3","Zbtb16","Kcnip4","Slc12a5","Kcnc4","Car12","Chsy3","Dnah9","Cdhr1","Fam81a","Grm1","Kcnab2","Rasl10a","Grb14","Slc30a3","Tmem117","Gal","Insc","Gsg1l","Kitl","Rbp1","Cpa2","Pappa2","Nell1","Sapcd1","Fam84a","Prox1os","Prkch","Sema5a","Shroom3","Tshz1","E130308A19Rik","Deptor","Glis3","Mfap4","Gm15398","Ror1","Bmper","Prdm5","RP23-291B1.2","Serping1","Zfp536","Antxr2","Ezr","Sema5b","Lrrtm3","Gfra1","Dap","Syn3","Nrg2","Sema3a","Gm20642","Adamtsl3","Samd12","Afap1l1","Tbc1d4","Dtx4","Gm11713","4921534H16Rik","Ppp1r16b","Cygb","4930590L20Rik","Necab3","Pvrl1","Tnr","Syt9","Maml3","Gm16183","Parm1","Fbxl7","Kcnh8","Kcnt2","Itga6","Plcb4","Bcl11b","Calcoco1","Tmod1","Satb1","1700111E14Rik","Hist1h2bc","Ptpro","Aff2","S100a16","Nrg3os","Atp2b3","Cxcl14","Gad1","Itpr2","Ryr2","Fgf9","Gabrg3","St18","Cdh9","Grik3","Nhs","Glra2","Arhgap15","Adam12","Ctxn2","Gm11837","Camk2a","Fam135b","Lin7a","Ccdc85a","Tacr1","Rcan3","Lingo2","Tmem191c","Dusp15","Sorcs2","Sv2b","Akap7","Kcnj6","Ctnna3","Tspan18","Kirrel3","Ung","Uhrf1","Cdca7","Sox2","Eomes","Tfap2c","Ascl1","Hmgb2","Dtl","Mcm2","Tcf19","Sox9","Rfx4","Cdt1","Cdk6","Dach1","Mcm6","Sox6","Rftn2","Mcm3","Myo10","Gins2","Thrsp","Grb10","Csrp1","Gli3","Kcnj10","Efhd2","Tead2","Gfap","Chaf1b","Sox1","Nkd1","Dhfr","Cenpm","Atp1a2","Rmst","Adgrv1","Top2a","Neurog2","Dna2","Mfge8","Rhbdl3","Pon2","Phgdh","Lig1","Msn","Megf11","Slc25a18","Loxl1","Clic1","Gm38399","Inppl1","Cdkn2c","Atad2","Veph1","Gpc6","Eya4","Egfr","Ccne2","Aif1l","Lockd","Id1","Clic4","Tk1","Tox3","Afap1l2","Slco1c1","Phldb2","Celsr1","Myl9","Cmtm7","Fam210b","Acads","Bcl2l12","Tac2","Nhlh1","Ebf1","Neurod4","Nxph4","Abcb9","Zic1","Scrt2","E130114P18Rik","Ppp1r14a","Plekhf2","Lama2","Serpinh1","Tmem163","Gm11266","Gldc","Myo1a","Gm29771","Lgals1","Gm13589","Zfp423","Zfp521","Cd1d1","Phf21b","Otx1","Rgs12","Ctnna1","Adamts19","Phactr4","Foxo3","Crip1","Lef1","Cdk2ap1","Cd164","Kif6","Arhgap31","Efs","Ttyh2","2600014E21Rik","Plcxd2","Rnf122","Xkr7","Klf3","Dmrta2","Gm11817","Slc15a2","B3glct","Trp53inp1","4930545L23Rik","Tcf7l2","Tpbg","Elavl4","Daam2","Mid1"],[9975.07762815393,8786.94431282917,6500.47371314017,6245.87308777025,5175.16480731971,4826.51694158002,4572.58114543206,4096.20750450444,4095.86486061892,3950.52096526036,3918.78972736426,3869.77050825249,3798.07724072742,3745.96640330234,3743.76809820513,3507.67063995141,3432.53983286101,3414.45120184325,3263.17910083579,3225.15569640897,3046.47342518703,3039.98602079034,2982.83632939479,2929.78853711037,2814.51839202604,2794.21492102277,2768.75266949186,2767.24239647465,2676.26770485523,2569.9831024036,2510.61481791336,2335.8275768577,2255.93934400089,2196.90221173664,2123.84647386031,2054.52969502068,2034.62934972918,2025.44936058245,2021.21195919667,1961.98029288729,1911.71708849519,1838.34906841961,1723.89104450797,1686.88886498101,1674.57157044123,1670.17717087929,1662.3144535908,1649.43917673906,1587.97953320321,1559.77841725482,1411.60854567711,1401.95570525761,1373.72999632223,1294.96526968048,1288.74937692923,1272.34039944353,1259.75050643409,1257.65686469436,1234.87497685194,1232.86688270998,1227.87519204265,1224.76308547984,1205.1735862948,1202.36615571898,1184.4170465882,1174.13842963995,1169.10223018253,1167.43278827913,1126.44246338394,1109.04201857848,1094.93906348285,1090.31498734655,1081.74765251393,1071.27399120984,1068.66344751585,1061.68893153601,1039.35725829984,1024.00018870408,1022.60056219935,1011.67648355313,1010.26098623431,1007.92751488188,979.746664024318,961.246567329824,950.115631055964,939.307546683684,927.548367360644,874.231092487434,871.392475329534,860.962184850229,858.84397807218,822.358689784002,762.326464097049,728.199625304738,719.840283491868,663.503987955183,646.789591815291,644.309453425148,639.421949193949,584.013470973424,559.999660076874,553.897613222241,546.933077526467,536.592974225526,536.014764029919,519.494853057176,509.953121427325,507.937367199774,505.122730402091,482.291739181018,421.547617418631,409.069699853172,388.954240312412,378.375794548661,369.76543302526,366.360671087557,350.989138492597,343.195103792546,333.871035776241,331.156945344083,319.324892190837,317.487247038391,301.45342450018,300.619019426029,288.313835299479,287.15584740382,286.129524104029,279.614039331015,275.406878124874,274.712778195664,220.244558120182,211.887287094371,178.518533388593,158.839416400452,155.784901234052,148.662536537374,121.569668439912,121.237657325581,117.013365365785,0,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.11022302462516e-16,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[3963.92569703551,6445.06711296374,3697.30160769487,3517.05742711896,0,3479.62533813592,1021.824987593,966.119122072056,3082.32663372679,1087.53070804251,2637.38074122122,2630.3194346688,796.093219864847,1465.4482510113,1556.87171297838,1681.43647853607,1244.72492509845,296.932638802156,1601.96520656753,1314.71485311966,1999.91622832501,1806.73023406997,763.117220163896,156.933194912017,515.243043813327,2475.7236718154,670.531570296309,1962.27886106533,591.759770378409,1115.86507098326,1365.22921248202,2057.3864220375,1451.89817307779,950.372206777154,446.890829696625,1125.05913624943,781.083124596436,768.271333149932,890.513940311402,853.808383562792,1064.19280317881,121.224913840044,1059.66186832362,696.443466287604,641.284034055357,539.900877145598,1065.97227427632,422.071970071038,377.216295612406,1290.36208161272,431.284561862576,602.05472107668,466.458932806831,453.098241896397,94.1399076633844,1028.38702308752,1170.03889453785,896.015933968663,203.931805088278,204.866894200048,169.116221229433,43.1878046174582,333.855951172275,29.2441232818153,455.426554576035,157.803159440974,647.378867796691,108.289256497034,2.64821693383629,449.295373790266,549.389818759404,683.91470916893,352.97632275574,324.947725464559,527.388540360899,718.31755683438,371.117453548093,883.820490998865,263.951284219752,367.980180138685,363.207453092166,607.466842199675,322.647801939811,457.364509948633,867.697912541908,174.27466954053,48.1484662607755,235.051726143065,487.727390638707,662.605006872419,361.849884721181,367.679901506124,714.950117082126,223.948561800413,271.824822471895,175.886924393256,309.571488279808,27.5903683573575,280.35997433295,193.145572174653,210.009409145447,444.475447148675,102.773165855626,203.264927014892,227.984396754923,202.531714777134,149.668675186,188.306232380374,226.959198297516,26.1353835563181,85.5912960781081,123.877841533406,124.602622245133,33.0511882156461,80.5155238690405,5.97153706789103,50.9472005212238,138.229871454149,32.5542704891561,4.25551629003942,39.7500117909064,419.790107506882,22.3131558046705,42.8367897968076,33.1403000715993,73.9327584031968,212.850478783907,248.257149044435,239.124394642859,74.2344462798209,191.631840008678,38.7699148836676,27.900537374502,152.517814274764,126.249734078767,18.0699585531836,67.2723144775082,100.422853867908,13.8668205569434,3335.29886190868,null,null,99.727078054544,null,null,null,null,1080.12789717422,71.6442350200861,190.046553144467,null,null,null,113.273427980387,null,144.0269898311,null,null,null,null,null,null,null,null,null,null,738.060638634683,null,1471.54272940369,null,31.6591678438063,null,2045.87458747638,null,7.21962276915247,null,9.52326640712604,128.949654090323,2.02011259903963,141.178033497923,null,null,212.469923973027,null,null,null,280.392814185972,null,null,66.7853193930999,null,22.4786336287701,null,null,null,null,341.860750819349,null,null,null,null,358.678867092633,null,null,null,null,null,null,null,268.8175383589,null,null,66.625220685451,null,1453.28493549322,null,null,124.288628725826,0.888281927352871,6.67431248432793,null,null,null,1038.14641012749,null,null,0,218.65981136307,null,null,744.879813908969,67.4994931519086,null,685.168594828004,15.1226819793468,195.45344324141,232.513287161494,4.64520532020703,22.1375453285114,340.941892398438,null,null,13.7528125980837,null,154.367904470525,null,25.9688833875766,128.788818577878,207.336379591521,278.389185787308,912.807174389221,286.413284515321,null,null,null,null,null,null,565.435388555115,null,223.640213448776,null,null,null,null,32.8800388759009,null,0.943609603352514,null,null,148.079364775411,1227.30436232726,112.171940483204,211.481276726463,null,null,null,null,null,23.1865967748243,46.5004496413081,null,88.9023295169227,null,null,7.75569880616908,48.4879014027071,null,null,null,304.013711445667,null,0.127435748273848,null,null,8.21573267635772,null,null,null,null,283.745702943909,null,4.24668451997035,163.772083768679,729.366649244155,108.952056885989,null,14.0294249636496,485.284486289189,null,null,null,2517.19607003335,155.276731962793,null,null,null,null,19.6629088966104,null,null,null,null,104.006877730352,null,null,1223.01209338534,null,null,258.568999828921,1428.54991879362,null,null,null,966.653617060123,null,124.144200904443,null,null,null,null,270.273153130179,null,null,null,null,2273.54892846673,null,1512.04663466147,null,1846.67150945534,1408.04724060362,null,null,null,506.062814666364,1478.48994942093,null,null,1260.53863117637,null,null,601.054741281415,null,null,null,null,null,648.032807258482,null,2664.86694984958,null,null,null,498.052808603437,null,520.110346992072,1673.50544388445,null,null,null,null,827.179101107879,794.002517312718,1016.34136939232,null,1884.20776084586,1475.13410697499,null,null,null,null,null,1339.18902003076,null,null,null,null,799.817399035437,682.179194162306,4449.28933720584,null,433.809391223887,null,null,898.42985499048,312.856164167802,697.449404751451,null,null,null,null,344.606692282564,null,null,391.413062854961,null,451.86315596512,null,null,null,null,null,122.78843184591,null,143.045108101132,null,null,null,77.9132954608357,null,56.5165609497465,null,null,null,235.684895904571,null,null,null,628.603982343167,null,null,null,null,287.309060471175,123.444624612457,null,null,null,null,250.045495475625,227.712685726552,null,null,138.015581097511,160.280012588113,211.545001172999,217.99191246511,null,null,null,null,1061.13013932117,null,null,null,null,null,null,null,null,323.655791156993,null,183.669127562373,null,616.22963841101,null,75.9790426631733,null,null,165.241025581001,null,0,129.828608614091,370.415672424828,null,null,null,null,763.073507493668,2077.45829948684,null,null,660.570878590639,null,278.676619166024,null,null,4475.50646194142,null,null,null,null,283.869811036325,3744.61678984088,null,null,null,1065.67709695312,null,936.329164142555,null,1257.90167308841,null,null,null,null,null,1432.25394632836,null,null,null,null,null,null,175.776160382055,null,null,null,801.873735651643,null,null,628.388494447762,null,440.56466109719,null,null,null,null,228.695310630897,null,null,null,56.2947037501042,null,null,264.353664581882,null,null,null,1239.99314385376,null,null,1439.9559620893,null,null,null,223.05447412413,107.812987601095,null,null,null,null,null,417.458534414782,null,0,null,0,null,null,236.95920094501,null,92.7879939742935,null,300.468263909831,null,null,202.277732098176,null,null,null,null,271.387676796588,189.241100069677,null,null,139.506532742332,null,970.746089381234,null,null,null,null,null,298.775509890875,886.713588487517,null,null,null,617.905436153874,null,null,635.532514909802,314.407229235815,null,47.687581756991,null,119.472806325287,408.478617876581,354.152178633598,null,197.987388173381,null,191.877049324376,null,229.962833145596,240.809885953546,152.405879098496,null,null,null,408.830312228496,null,null,null,null,139.958537869671,null,null,89.664957851063,400.949201100885,null,null,null,null,null,null,null,210.934069726592,null,null,null],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,null,6,null,null,null,null,6,6,6,null,null,null,6,null,6,null,null,null,null,null,null,null,null,null,null,6,null,6,null,6,null,6,null,6,null,6,6,6,6,null,null,6,null,null,null,6,null,null,6,null,6,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,null,6,null,null,6,null,6,null,null,6,6,6,null,null,null,6,null,null,6,6,null,null,6,6,null,6,6,6,6,6,6,6,null,null,6,null,6,null,6,6,6,6,6,6,null,null,null,null,null,null,6,null,6,null,null,null,null,6,null,6,null,null,6,6,6,6,null,null,null,null,null,6,6,null,6,null,null,6,6,null,null,null,6,null,6,null,null,6,null,null,null,null,6,null,6,6,6,6,null,6,6,null,null,null,6,6,null,null,null,null,6,null,null,null,null,6,null,null,6,null,null,6,6,null,null,null,6,null,6,null,null,null,null,6,null,null,null,null,6,null,6,null,6,6,null,null,null,6,6,null,null,6,null,null,6,null,null,null,null,null,6,null,6,null,null,null,6,null,6,6,null,null,null,null,6,6,6,null,6,6,null,null,null,null,null,6,null,null,null,null,6,6,6,null,6,null,null,6,6,6,null,null,null,null,6,null,null,6,null,6,null,null,null,null,null,6,null,6,null,null,null,6,null,6,null,null,null,6,null,null,null,6,null,null,null,null,6,6,null,null,null,null,6,6,null,null,6,6,6,6,null,null,null,null,6,null,null,null,null,null,null,null,null,6,null,6,null,6,null,6,null,null,6,null,6,6,6,null,null,null,null,6,6,null,null,6,null,6,null,null,6,null,null,null,null,6,6,null,null,null,6,null,6,null,6,null,null,null,null,null,6,null,null,null,null,null,null,6,null,null,null,6,null,null,6,null,6,null,null,null,null,6,null,null,null,6,null,null,6,null,null,null,6,null,null,6,null,null,null,6,6,null,null,null,null,null,6,null,6,null,6,null,null,6,null,6,null,6,null,null,6,null,null,null,null,6,6,null,null,6,null,6,null,null,null,null,null,6,6,null,null,null,6,null,null,6,6,null,6,null,6,6,6,null,6,null,6,null,6,6,6,null,null,null,6,null,null,null,null,6,null,null,6,6,null,null,null,null,null,null,null,6,null,null,null],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.07075423194658e-07,0,5.4694280971046e-05,0,0,0,0,0.851525009743438,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.10359298366447e-08,0,0,0,0,0,0,0,0,0,0,0.000112206465161302,0,0,0,0,0,0,0,0,0,0,0,0.000210076876774101,2.22044604925031e-16,0,0,1.02506838739469e-05,2.77555756156289e-15,0.42638607512452,3.03508751464676e-09,0,1.27730892391931e-05,0.642141581449576,5.1005065715426e-07,0,0.00106238346925869,1.2564684348515e-07,9.85373206863205e-06,6.36157793110215e-14,0,0,0,5.51780843238703e-14,0,7.94060210584924e-07,9.81029382287613e-05,0,0,0.00605972294521562,1.48048240333765e-12,0,0.0311597532644891,0,null,null,0,null,null,null,null,0,1.87960758069039e-13,0,null,null,null,0,null,0,null,null,null,null,null,null,null,null,null,null,0,null,0,null,1.89647206795263e-05,null,0,null,0.301013449690336,null,0.146217577963812,0,0.917839580425009,0,null,null,0,null,null,null,0,null,null,1.86217707920378e-12,null,0.000991289705507659,null,null,null,null,0,null,null,null,null,0,null,null,null,null,null,null,null,0,null,null,2.00794936233706e-12,null,0,null,null,0,0.989495116226983,0.352019077849643,null,null,null,0,null,null,1,0,null,null,0,1.3301582058034e-12,null,0,0.0193236890358263,0,0,0.590053966011463,0.00114330156857911,0,null,null,0.0325226239305406,null,0,null,0.000225633694233229,0,0,0,0,0,null,null,null,null,null,null,0,null,0,null,null,null,null,1.1058080389259e-05,null,0.987659880645068,null,null,0,0,0,0,null,null,null,null,null,0.000736331416685276,2.35339635556997e-08,null,0,null,null,0.256553387398049,9.43955702492616e-09,null,null,null,0,null,0.999958893403563,null,null,0.222720458585218,null,null,null,null,0,null,0.643332317815044,0,0,0,null,0.0293091922826615,0,null,null,null,0,0,null,null,null,null,0.00317894663597973,null,null,null,null,0,null,null,0,null,null,0,0,null,null,null,0,null,0,null,null,null,null,0,null,null,null,null,0,null,0,null,0,0,null,null,null,0,0,null,null,0,null,null,0,null,null,null,null,null,0,null,0,null,null,null,0,null,0,0,null,null,null,null,0,0,0,null,0,0,null,null,null,null,null,0,null,null,null,null,0,0,0,null,0,null,null,0,0,0,null,null,null,null,0,null,null,0,null,0,null,null,null,null,null,0,null,0,null,null,null,9.65894031423886e-15,null,2.28854490913477e-10,null,null,null,0,null,null,null,0,null,null,null,null,0,0,null,null,null,null,0,0,null,null,0,0,0,0,null,null,null,null,0,null,null,null,null,null,null,null,null,0,null,0,null,0,null,2.40918396343659e-14,null,null,0,null,1,0,0,null,null,null,null,0,0,null,null,0,null,0,null,null,0,null,null,null,null,0,0,null,null,null,0,null,0,null,0,null,null,null,null,null,0,null,null,null,null,null,null,0,null,null,null,0,null,null,0,null,0,null,null,null,null,0,null,null,null,2.53769560920603e-10,null,null,0,null,null,null,0,null,null,0,null,null,null,0,0,null,null,null,null,null,0,null,1,null,1,null,null,0,null,0,null,0,null,null,0,null,null,null,null,0,0,null,null,0,null,0,null,null,null,null,null,0,0,null,null,null,0,null,null,0,0,null,1.36421240970463e-08,null,0,0,0,null,0,null,0,null,0,0,0,null,null,null,0,null,null,null,null,0,null,null,0,0,null,null,null,null,null,null,null,0,null,null,null],[3504.0422593347,1866.02603581908,330.905368374843,960.46108426029,null,1097.31887760823,2335.27664258367,1244.46757820626,498.747290554402,1178.08454405837,null,382.103010115336,1415.5668101896,1825.49762245901,1592.97582554534,1276.54298180241,null,2545.54179471251,1591.21975540936,1791.28391844827,454.723418372892,1141.02378228596,1078.45269717609,null,1861.55533169073,278.141455316712,null,779.166776111938,null,870.081501384927,412.448309436787,155.44645263377,741.036398843434,924.594336804691,964.727444754363,267.89368910488,1103.58241263561,676.710513455083,490.943272620773,538.298960941287,492.151714277687,1586.94679419212,340.078456926825,842.192152526523,560.256326261329,null,547.66987074729,689.152917868772,475.379488538299,242.437525974916,586.391446509303,374.173360064942,518.773677699032,526.468511447227,980.594415756358,134.912340247466,67.9264867749477,159.220489899524,0,929.306054131549,null,1015.90301150006,334.799835042121,243.651000809746,263.940397969945,818.711221361089,33.040568029106,873.279063694449,31.9830449806302,363.202138908767,413.062156565694,455.165723188551,333.871310141224,651.730262499318,346.113687722226,94.0364372894781,347.8990497,45.3196244486493,396.2029481013,342.439305618277,301.049685384244,337.340744285666,601.042426215278,396.864133612627,72.9749605976366,258.680486607769,17.2325471131249,2004.104192278,409.540689834876,172.512399631386,144.649434725883,283.193116421924,3.27812727895363,392.323997242748,391.86066519056,245.75136189859,186.351747282789,139.631315895632,216.450486038645,45.9973488357298,212.402150833179,101.344289128193,200.272526252954,156.43365604261,null,26.7895579337172,205.351285286754,207.696569001506,176.064394284303,338.762850701699,191.401181033582,173.865403048848,79.6032486374119,83.9348709225494,100.192998508873,62.6873007897295,109.794108699243,184.34786305875,93.3976823462629,null,109.941161938966,2.19026107191028,199.561842038664,148.632648313887,137.76714989885,21.8290650403834,21.1736174771813,103.192625156123,19.894388014857,11.5648275359223,124.460893840379,161.983552103287,118.221374565921,8.51037068131774,7.20092393094809,100.366680373446,33.4009073752296,null,63.9803758834823,316.568080113743,null,null,1065.35095187445,null,null,334.99178133258,null,null,202.226370381031,null,null,128.560921869162,802.360898220143,null,null,null,414.954950516689,906.004726645681,null,null,205.555926333644,0,null,160.339916470508,null,225.258409401077,109.570460981028,null,782.558504436694,193.507848055708,null,null,null,null,null,477.897548212702,null,null,null,null,null,null,null,48.0501506382044,null,32.4141371399237,null,null,130.728803014294,null,0,null,55.0189027116509,null,null,398.057911529104,593.606824756707,57.9671382419921,null,1698.78345260902,1964.79384847171,null,196.770389606795,109.576392249398,79.3381540728672,79.8055292064367,132.545993895928,null,null,null,136.423845238143,103.157482772656,null,179.379295286489,null,null,221.845573711422,439.632198354966,null,null,null,170.845903255985,null,null,null,null,null,null,null,null,null,null,null,null,null,266.06751028544,null,null,null,null,null,103.287374373146,null,121.047700651735,null,null,null,144.63306232632,null,null,null,null,null,1396.74882596439,96.4348573254695,113.398089156335,null,167.296119084309,null,null,null,null,539.882957871586,null,5.09749833955835,null,324.468213385176,null,52.9774612637789,1312.24358527737,null,null,null,null,null,null,390.081944575597,null,null,null,null,31.0766413038556,null,null,null,null,null,null,null,null,null,298.335948869368,null,1606.46393714645,null,341.17603980525,null,1398.22143042443,null,null,null,1111.7036872383,null,null,1429.01666057777,null,790.073223501643,null,1197.48845179902,null,null,1450.05315234999,null,null,1507.06586938038,539.405140793149,null,929.108700882276,null,436.76436269248,740.798091628834,null,235.327052844507,null,1499.87467299257,292.719798466457,null,1018.70544927536,359.038255101657,null,null,null,null,270.721935042473,null,1274.56392238539,null,null,283.605880341767,null,null,null,null,null,null,null,null,null,null,null,null,332.019618700435,121.161025667478,null,8.36076556885179,null,null,null,278.83143276941,null,325.014695672603,null,null,null,223.78132356835,null,272.845353549129,null,null,null,298.557165248568,499.000581509436,null,59.1572780982087,177.854983427203,null,63.071379049615,108.925973282113,48.4602225903655,null,null,null,null,null,null,649.559567539757,148.966327331491,null,31.4804710639984,null,192.233240757492,null,357.714228884166,null,null,null,null,null,null,243.179619471914,null,1247.40970598223,null,28.4533916298254,null,149.766309669238,null,null,null,589.400001486715,376.252209020889,374.270174106527,null,null,null,null,null,null,17.854643712259,57.3398098063573,53.6622169125556,null,null,null,133.343838383616,21.0239678141216,null,283.258962216774,null,null,54.8178194046267,null,null,136.517499507023,null,0,38.9000012273559,70.1698253166449,237.549461402418,null,121.773504995176,1362.72766341934,596.638664084339,null,null,null,null,null,314.086615606109,396.528202456318,null,null,12.8553421442334,259.315954390531,244.918417031284,null,null,null,null,380.972211095725,null,null,null,59.3570867015317,847.528911456999,10.5519465053083,58.3566403938381,null,null,null,null,null,867.594645497858,null,186.26225647528,null,null,null,462.440063858693,null,null,437.039225601475,250.655426710159,null,null,null,null,null,174.226882659713,null,null,null,95.6559164754726,null,null,39.6370713038513,null,26.5406124179978,null,428.129177944874,304.261697303896,770.505711293059,80.1724805800557,39.0761103708024,null,1239.02863908582,44.1104703525275,539.09771433129,null,87.1756911122767,null,24.6035276790929,null,979.107339883087,null,554.238121769838,372.317687796271,null,null,null,null,null,null,null,null,null,null,372.764010491884,872.756236617986,null,null,null,null,182.186622261187,null,70.5708264318177,316.238650477478,null,null,null,114.916737567679,849.04314654267,675.125480442096,null,null,220.060996477665,null,null,356.541788125935,null,null,null,null,1693.31278333849,529.911648927525,null,null,null,107.083515643159,null,132.941448616506,null,null,274.561752727021,null,null,null,260.365242004902,89.101412794249,null,null,null,145.218486720336,122.89497066658,null,233.635805584834,256.733773794219,null,null,81.1729969619302,null,120.778219008923,237.444711002469,null,null,152.062757456253,347.307286304955,null,null,null,null,null,247.020593843074,null,446.485754953443,null,687.326371164333,null,null,null,668.494727401743,220.714079268074,null,null,null,null,null,142.18554533789,null,null,null,null,null,216.556557785259,null,260.858387413481,null,null,null,null,null,1754.62497333674,null,17.1815794203344,null,282.075158155303,null,null,null,null,null,null,null,null,null,null,null,56.5887154012253,null,null,802.607583207184,null,176.107672475307],[6,6,6,6,null,6,6,6,6,6,null,6,6,6,6,6,null,6,6,6,6,6,6,null,6,6,null,6,null,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,null,6,6,null,null,6,null,null,6,null,null,6,null,null,6,6,null,null,null,6,6,null,null,6,6,null,6,null,6,6,null,6,6,null,null,null,null,null,6,null,null,null,null,null,null,null,6,null,6,null,null,6,null,6,null,6,null,null,6,6,6,null,6,6,null,6,6,6,6,6,null,null,null,6,6,null,6,null,null,6,6,null,null,null,6,null,null,null,null,null,null,null,null,null,null,null,null,null,6,null,null,null,null,null,6,null,6,null,null,null,6,null,null,null,null,null,6,6,6,null,6,null,null,null,null,6,null,6,null,6,null,6,6,null,null,null,null,null,null,6,null,null,null,null,6,null,null,null,null,null,null,null,null,null,6,null,6,null,6,null,6,null,null,null,6,null,null,6,null,6,null,6,null,null,6,null,null,6,6,null,6,null,6,6,null,6,null,6,6,null,6,6,null,null,null,null,6,null,6,null,null,6,null,null,null,null,null,null,null,null,null,null,null,null,6,6,null,6,null,null,null,6,null,6,null,null,null,6,null,6,null,null,null,6,6,null,6,6,null,6,6,6,null,null,null,null,null,null,6,6,null,6,null,6,null,6,null,null,null,null,null,null,6,null,6,null,6,null,6,null,null,null,6,6,6,null,null,null,null,null,null,6,6,6,null,null,null,6,6,null,6,null,null,6,null,null,6,null,6,6,6,6,null,6,6,6,null,null,null,null,null,6,6,null,null,6,6,6,null,null,null,null,6,null,null,null,6,6,6,6,null,null,null,null,null,6,null,6,null,null,null,6,null,null,6,6,null,null,null,null,null,6,null,null,null,6,null,null,6,null,6,null,6,6,6,6,6,null,6,6,6,null,6,null,6,null,6,null,6,6,null,null,null,null,null,null,null,null,null,null,6,6,null,null,null,null,6,null,6,6,null,null,null,6,6,6,null,null,6,null,null,6,null,null,null,null,6,6,null,null,null,6,null,6,null,null,6,null,null,null,6,6,null,null,null,6,6,null,6,6,null,null,6,null,6,6,null,null,6,6,null,null,null,null,null,6,null,6,null,6,null,null,null,6,6,null,null,null,null,null,6,null,null,null,null,null,6,null,6,null,null,null,null,null,6,null,6,null,6,null,null,null,null,null,null,null,null,null,null,null,6,null,null,6,null,6],[0,0,0,0,null,0,0,0,0,0,null,0,0,0,0,0,null,0,0,0,0,0,0,null,0,0,null,0,null,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,null,0,0,0,0,0,0,0,0,0,0,1.08768549722527e-12,0,1,0,null,0,0,0,0,0,1.02990371482203e-05,0,1.64401686640891e-05,0,0,0,0,0,0,0,0,4.04330321446267e-08,0,0,0,0,0,0,1.00142116821189e-13,0,0.00846554283064782,0,0,0,0,0,0.773215910482117,0,0,0,0,0,0,2.96415243461468e-08,0,0,0,0,null,0.000158559508463219,0,0,0,0,0,0,4.32986979603811e-15,5.55111512312578e-16,0,1.2781664615602e-11,0,0,0,null,0,0.901394970876517,0,0,0,0.0013003234804716,0.00170737117490727,0,0.00289183194287113,0.0724115714408387,0,0,0,0.20304401127725,0.302665058558596,0,8.77824864442545e-06,null,6.96587232340562e-12,0,null,null,0,null,null,0,null,null,0,null,null,0,0,null,null,null,0,0,null,null,0,1,null,0,null,0,0,null,0,0,null,null,null,null,null,0,null,null,null,null,null,null,null,1.15466520789198e-08,null,1.35896309421124e-05,null,null,0,null,1,null,4.59492888182922e-10,null,null,0,0,1.16363141344777e-10,null,0,0,null,0,0,4.88498130835069e-15,3.88578058618805e-15,0,null,null,null,0,0,null,0,null,null,0,0,null,null,null,0,null,null,null,null,null,null,null,null,null,null,null,null,null,0,null,null,null,null,null,0,null,0,null,null,null,0,null,null,null,null,null,0,0,0,null,0,null,null,null,null,0,null,0.531370513235816,null,0,null,1.18561638284831e-09,0,null,null,null,null,null,null,0,null,null,null,null,2.45092955208914e-05,null,null,null,null,null,null,null,null,null,0,null,0,null,0,null,0,null,null,null,0,null,null,0,null,0,null,0,null,null,0,null,null,0,0,null,0,null,0,0,null,0,null,0,0,null,0,0,null,null,null,null,0,null,0,null,null,0,null,null,null,null,null,null,null,null,null,null,null,null,0,0,null,0.212845936653356,null,null,null,0,null,0,null,null,null,0,null,0,null,null,null,0,0,null,6.67468302850693e-11,0,null,1.06739062033512e-11,0,9.56062806700686e-09,null,null,null,null,null,null,0,0,null,2.05183619695903e-05,null,0,null,0,null,null,null,null,null,null,0,null,0,null,7.71747060152039e-05,null,0,null,null,null,0,0,0,null,null,null,null,null,null,0.00660590233598191,1.55924273492758e-10,8.62956706093598e-10,null,null,null,0,0.00181651296556473,null,0,null,null,5.04520314414947e-10,null,null,0,null,1,7.48800205285782e-07,3.77364806070091e-13,0,null,0,0,0,null,null,null,null,null,0,0,null,null,0.0453915121375763,0,0,null,null,null,null,0,null,null,null,6.07957018061711e-11,0,0.103251070720938,9.70181712744989e-11,null,null,null,null,null,0,null,0,null,null,null,0,null,null,0,0,null,null,null,null,null,0,null,null,null,0,null,null,5.36772887804737e-07,null,0.000176499407045116,null,0,0,0,3.33066907387547e-15,6.91588013967959e-07,null,0,7.02843219180238e-08,0,null,1.11022302462516e-16,null,0.000404248040139388,null,0,null,0,0,null,null,null,null,null,null,null,null,null,null,0,0,null,null,null,null,0,null,3.12305736827057e-13,0,null,null,null,0,0,0,null,null,0,null,null,0,null,null,null,null,0,0,null,null,null,0,null,0,null,null,0,null,null,null,0,0,null,null,null,0,0,null,0,0,null,null,1.99840144432528e-15,null,0,0,null,null,0,0,null,null,null,null,null,0,null,0,null,0,null,null,null,0,0,null,null,null,null,null,0,null,null,null,null,null,0,null,0,null,null,null,null,null,0,null,0.00863857577388272,null,0,null,null,null,null,null,null,null,null,null,null,null,2.21289209179076e-10,null,null,0,null,0],[2483.31783949634,1212.96878199144,2565.18319236671,1226.29814187851,421.287262996567,247.818913413655,1560.28951759238,1853.69459091339,736.368764485602,1830.15577409081,643.993472401081,848.840894544684,939.124068668456,328.648423596208,683.932595261472,1114.86263888426,617.19244369464,653.649374925394,72.5622862040031,107.573629955124,594.871720723971,89.5855912452371,1067.83100898687,693.058416349189,392.939066546002,40.4969583973194,616.377524067641,53.4842407706165,1585.65812844089,581.590183974031,740.30865714277,119.685287096105,76.6134937797091,375.28752655597,956.565155595934,583.976497100732,151.965847708821,581.874545688204,626.716353383384,505.430793647196,361.60043696369,130.825742786521,454.148570878119,152.742402815472,633.401875243841,78.6806456351722,48.8089675700659,595.853663905555,506.885960904693,28.3024333818226,595.311895470807,425.709948940827,372.705312740042,314.939870662454,215.225623673239,88.1764509894278,8.7143114360282,216.311038150372,207.581839474666,98.9562235954538,487.880184609799,166.767098337932,428.122476704389,262.442424845056,464.879089259022,194.762301238189,43.28038990879,197.488220815698,1094.6799115934,229.312899721682,404.450393046306,124.71965120853,83.2944318213379,51.2916120481728,196.044306093141,251.263475563896,313.587513639583,97.8784617400839,287.717850925627,300.899567520348,124.32905938759,30.56447236638,92.7584753197787,279.720102170406,43.6282017779722,353.092185305123,860.101059661341,260.311258617475,257.148875610288,202.043070901592,388.665660057716,215.419274557762,46.8038787698299,255.487009110665,53.0162702462798,264.469269413679,285.970354316162,503.412679582754,180.434617953173,230.787709759165,127.114173324026,8.20918369111118,305.947276437131,195.411951289681,227.607486926945,264.361123288017,235.807167676226,114.377829791161,227.235574307806,118.691273316824,216.523878921743,111.681524488124,140.265236330259,203.08096056179,190.546863932171,136.447187408668,240.563807839316,11.989591631033,210.400867993122,294.829739093779,152.860531667942,4.45513929171774,66.1694598093734,145.793806699221,133.989011418982,199.029091062626,59.9957216000156,230.736331880637,20.0917952282101,135.305731060976,120.196008000789,44.6295046911446,35.6758859089294,0.593671273453659,17.0922056287963,32.8589044300256,14.2442520380847,11.7709889930091,18.2559902307603,387.407060381163,null,564.376580943384,468.584777380579,null,1269.09947320304,329.891635194821,527.535354001706,1643.03974658418,193.361498776839,null,310.369762984194,311.932964267736,504.324981173436,637.374931620559,93.0195139750378,327.650743767915,759.121004137896,758.34063471823,205.422916653727,12.2760934283855,298.898325196855,120.442232637744,320.438678727714,242.117932012337,163.738533100222,195.323234234184,892.22176469035,585.122898742835,384.229514682985,166.450864275851,75.1866973377949,456.98818761271,273.945283801479,917.364997435767,25.7791973484587,278.020696543867,158.158157045292,461.357018057731,38.3318590601676,173.98464776706,73.1482464029427,98.3634949895714,986.174599110987,null,126.015377750548,217.951734332746,135.744097926619,207.326665161034,165.273458764152,227.5897898467,279.960015843278,96.684218580488,10.8167775852326,35.1492668736704,334.149827961165,631.10149736028,880.077711995608,59.8714579308567,1060.91885152518,295.824640262286,186.52783076189,191.079752441358,214.343292007318,125.821710683162,298.338635474522,45.824982771288,60.9289768895967,90.7200507267159,46.9625464502642,227.799144251097,245.493259463238,50.3657568874167,50.1236992111784,92.9672756998767,1543.85374244575,null,620.060356402217,1479.30270433491,272.094820883102,171.641123310296,455.889566769042,null,337.465480678363,1271.19891141301,1396.50179058438,129.387337426408,596.605320065082,385.441301617547,null,468.630044561646,1264.73242350777,700.720274853999,371.225214694749,null,524.783333860827,null,148.836847470616,528.107208833788,539.996908889744,null,464.045655771892,599.216823926923,166.688852623999,361.650156321306,232.760272108396,279.021320990348,327.776043052946,179.369565914812,1970.01492371565,292.666856392968,null,131.343306196336,297.052016067846,969.216704578414,215.105726811206,1206.10362781216,529.278224407262,876.663097273667,598.204826708888,547.384677449057,359.802562831434,91.5842923838497,null,301.06120941176,156.632243140521,300.933970727589,297.609141156167,114.257784412979,null,2537.82002422998,208.35676132631,755.393082876184,231.229563428396,129.248552080601,220.938493248171,255.435758788163,null,360.406925231765,303.167999355613,186.379534906329,452.88536958036,202.284726779189,353.686938677592,340.735703370308,652.767127089422,null,330.031049392149,222.906986553434,92.0369163798882,781.180146293465,160.346321671876,null,97.5864570660196,13.2671300815163,87.235751142328,null,201.927798428704,48.5170840519846,311.322927274543,76.480238911552,71.1634568204145,545.379601068206,41.3972463769569,96.2508182175154,null,182.646857865359,77.4779494901248,6.16091242034924,208.984094862655,188.635870396864,257.729650973099,1227.88119878602,256.030865879425,128.478471203999,308.518950164459,61.4202845616399,325.275354175005,394.92127102164,31.3693571636062,41.0327062772127,214.283283636198,301.580657009485,159.594113169821,0,742.484674149728,133.206818357183,251.51809154615,null,51.9021225267023,1035.9586446079,null,500.196543939763,39.1619500644785,8.43252190337509,196.297026249648,193.514462581516,23.4172704528137,226.452640213417,23.4971919869288,null,14.3640601713056,96.2731259729255,186.97283880979,17.1666702993478,169.526995714515,151.45438937536,42.6722269077732,92.8768551739418,null,104.763247595944,212.635600429778,113.298331000795,151.284510358978,4163.1387018678,1.10287810301321,10.8766172841307,84.4864989411446,134.847866882013,17.2663949184772,9.34257704933843,52.7688102085552,null,132.461734868003,57.7568206162186,15.0528898670239,37.3934860284575,6.1708559846273,3.86854962259428,6.59343225566129,169.13668305374,7542.28033771546,135.306549222121,292.529632222809,155.008976660919,null,147.945116960696,17.1891646340274,432.729579632549,55.8404130914828,59.0496263898634,59.8955137964477,596.908492666339,183.10663506143,null,232.737487172766,98.4878181811062,326.696453769547,125.820273189367,null,16.2080297708051,139.001496237372,14.4404877888636,6.02871097882951,141.704450513265,44.7276644918865,151.320056819254,46.8519452498665,2.36793725526593,64.4502364225432,256.21975849897,605.137199312419,181.559689123815,13.5634528518498,69.3136023448408,461.221885125851,298.245468614501,3.64506281723341,null,287.413655145108,39.683171003277,35.0012542277803,250.33559818555,13.7699470230622,138.88319912148,null,92.1362337138575,36.2784409489333,100.239649528806,12.2066793315146,25.7338517656714,136.557383192289,454.112518540404,50.3658731745361,null,182.584722375718,4.47596232106411,38.037780017198,410.434713207648,266.996583411119,168.973122428026,0.650633379723417,184.688907380829,1078.22110637426,118.637087012109,29.5922437858652,162.41708420933,62.6308738506891,86.2107436438986,275.198843152452,728.034325413459,157.44218048895,1064.8786641936,357.562634175666,null,1458.48996485864,61.0692334275996,423.522194704975,67.6203961864845,144.556711695152,376.139181745785,51.3778215149925,242.661402278328,15.8865213038574,326.189403142622,142.020538900609,8.65952789035933,123.956290057951,88.0153034199865,98.1275388678829,75.1001271976021,145.743894195408,60.8303898019158,183.450983452409,59.2444324031847,942.471692249365,33.0941944634706,149.771857848926,210.032549502516,32.1464579252455,194.37890448693,48.5143997882915,164.6178852596,1150.6030094023,148.128540853393,36.5155957056194,364.834142685049,24.8438577761671,78.9629500073633,251.161190382198,840.077251421669,140.576693711513,null,51.5734535434651,19.1613119902484,23.0618930712498,34.8595601301441,251.515091778887,70.3142515627907,559.979362114884,31.3323871677436,253.12079664664,389.214055927769,89.0588955625454,378.145215800652,40.8053501613089,84.0583668608711,102.805800910976,60.9467826415583,312.806170496465,282.70852934476,278.372393067179,null,9.2250855732061,200.170817926043,1105.6781798645,176.576134809798,86.4175770098636,85.9963472978104,241.755941587767,654.412963861595,48.5030978477755,351.277288546223,408.368672523789,1291.10023979157,574.836555159456,398.23589234802,331.586742567959,410.704782802002,604.923264428864,302.933950963101,305.72049543084,520.688904826852,501.511520733359,278.948900018114,432.229163172122,173.949866131945,215.56747799095,317.948789318365,842.108861725772,507.475337540349,625.313998699669,301.662824818149,472.897667736564,258.048917181609,421.839123644046,207.681471825183,750.470307813414,326.683491046387,212.416964071835,227.43289504665,221.557302163104,713.96470731898,503.409480140484,197.082840650634,250.182243997067,176.520532880343,195.10050294376,316.30480891906,197.598185636675,176.157662946336,840.750464128598,457.919434554064,224.704629652287,638.21699871513,192.296408809626,208.703019438557,223.771414120095,184.762540965439,163.25256152635,217.743810856777,178.967766841779,495.611760947963,186.214843576585,242.194429644318,263.694823438056,343.161427008922,161.44200395658,231.354329064057,168.092677544567,234.338257552046,255.440680623267,153.538389986264,159.579080209852,169.549198726644,146.945488450091,90.7993030070159,80.7739828813513,460.503886172057,142.646300721479,182.70639587022,116.17639974388,133.488738625836,196.453867308903,184.6004625536,83.4215047329399,125.28576673452,280.74340655543,null,176.622020992364,452.759731435997,292.409845667591,102.081011892576,146.74454054603,129.546286292393,382.91917030109,161.615029627808,573.505122019192,424.019035225794,100.709921538629,503.597639397675,583.177778416534,227.082136243004,338.626542043673,431.785986908991,258.558101247178,74.4559109084004,40.8413372841129,114.087561312416,79.3731051162775,208.292520474413,141.226871942087,141.714744945287,195.071194499696,137.077337792633,137.128834306168,288.940806171084,238.14023138284,224.756304360683,118.541855026222,87.3899162428343,292.949073508215,1445.42067400902,465.264890022447,75.6837767100697,112.585734221296,149.000247239276,112.225432620874,15.0962905293231,131.582180641879,235.378923602646,71.0686916480661,375.96706909824,263.220085214143,9.47891140052278,67.8372305756127,398.229422654451,62.2377300837861,68.4107457317342,158.641535392733,135.282080452798,1139.87306291054,76.8772496252142,207.034274139978],[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,null,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,null,5,5,5,5,5,5,null,5,5,5,5,null,5,null,5,5,5,null,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,null,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,5,null,5,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,null,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.99760216648792e-14,0,0,0,0,0,0,1.18551787831045e-07,0,2.67502020534494e-10,0,0,0,0,4.32986979603811e-15,0,0,0,0,0,0,0,0,0,0,0,0,1.55431223447522e-15,2.42798436911329e-09,0,0,3.17639523434998e-05,0,0,0,0,0,0,0.121016399381489,0,0,0,0,0,0,0,0,0,3.24175388755066e-08,0,0,0,0,0,2.22044604925031e-16,7.53705431399965e-10,0,0,0,0,0,0,0,1.14168550342519e-05,0,0,2.75571132579699e-08,0,0,0,0,0,0,0,6.22926921156619e-09,0,3.33757799175771e-10,0,0,0,0,0,0,0.1450776872543,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0349306778702426,0,0,0,0.485907991175409,6.40931752116103e-13,0,0,0,1.21793686247429e-11,0,0.00120111639991771,0,0,1.72556652300315e-08,1.10266870056996e-06,0.988291172143525,0.00432820577237003,4.01416644624231e-06,0.0141301180088942,0.0380641375769237,0.00264211032692352,0,null,0,0,null,0,0,0,0,0,null,0,0,0,0,0,0,0,0,0,0.031194375963301,0,0,0,0,0,0,0,0,0,0,8.54871728961371e-15,0,0,0,9.84786346037714e-05,0,0,0,3.23614452457655e-07,0,2.26485497023532e-14,0,0,null,0,0,0,0,0,0,0,0,0.0551362288753797,1.40488849464937e-06,0,0,0,1.2921108627495e-11,0,0,0,0,0,0,0,9.8585598573564e-09,7.81086306744783e-12,0,5.78223313674187e-09,0,0,1.166378216233e-09,1.30733079917178e-09,0,0,null,0,0,0,0,0,null,0,0,0,0,0,0,null,0,0,0,0,null,0,null,0,0,0,null,0,0,0,0,0,0,0,0,0,0,null,0,0,0,0,0,0,0,0,0,0,0,null,0,0,0,0,0,null,0,0,0,0,0,0,0,null,0,0,0,0,0,0,0,0,null,0,0,0,0,0,null,0,0.0210000166278814,0,null,0,2.78533418551774e-09,0,4.55191440096314e-15,5.86197757002083e-14,0,7.79928983618561e-08,0,null,0,2.77555756156289e-15,0.290874890253284,0,0,0,0,0,0,0,6.18127771190302e-12,0,0,7.91854176374063e-06,9.24111599465149e-08,0,0,0,1,0,0,0,null,5.64997382213051e-10,0,null,0,2.20308811305081e-07,0.133954581087753,0,0,0.000280866718562423,0,0.000271134398824535,null,0.0134549698450771,0,0,0.00419431208082832,0,0,4.30566912124064e-08,0,null,0,0,0,0,0,0.9538486048863,0.0538819279883834,1.11022302462516e-16,0,0.00402132369640595,0.0961556790615596,3.75173225819481e-10,null,0,3.53058693391972e-11,0.0101387221788209,4.99431736189493e-07,0.289947165279461,0.568492722513582,0.252674836918505,0,0,0,0,0,null,0,0.00415466767978079,0,8.76529959725758e-11,1.91008320271635e-11,1.27741150990346e-11,0,0,null,0,0,0,0,null,0.0062745680102777,0,0.0130406960378616,0.303435233542838,0,1.64810642910851e-08,0,6.09032335674442e-09,0.796239127156853,1.45716771982052e-12,0,0,0,0.0186336249365623,1.42330591756945e-13,0,0,0.601560260817733,null,0,1.72996793113001e-07,1.50378372154591e-06,0,0.017138707477141,0,null,0,8.35456905212695e-07,0,0.0320629576527033,0.000100490985095458,0,0,1.16631426738678e-09,null,0,0.483106025190721,3.70787214820645e-07,0,0,0,0.985567792484843,0,0,0,1.77400632263014e-05,0,3.47144535339794e-12,0,0,0,0,0,0,null,0,7.30615568045323e-12,0,3.20188320301895e-13,0,0,7.23658688528417e-10,0,0.00717564055950182,0,0,0.123439669114104,0,0,0,8.88178419700125e-15,0,8.18622947207359e-12,0,1.7411072583684e-11,0,3.60477479544041e-06,0,0,5.55739228835783e-06,0,2.78885281534968e-09,0,0,0,7.48936150429813e-07,0,0.000149346182690691,1.33226762955019e-15,0,0,0,null,6.59833521154951e-10,0.00179357403458935,0.000328491928761498,1.60493699585817e-06,0,8.81517081552374e-14,0,8.05289937699794e-06,0,0,0,0,1.02718089256548e-07,1.11022302462516e-16,0,7.74491581978509e-12,0,0,0,null,0.10041609439982,0,0,0,0,0,0,0,2.80371670324797e-09,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.55111512312578e-16,0,0,0,0,0,0,0,1.11022302462516e-16,0,0,null,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.21014309684142e-14,1.01013470144018e-07,0,1.11022302462516e-15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.66133814775094e-15,0,0,0,0.00995873025776473,0,0,6.13953332617712e-14,0,0,0.0914203927832146,2.88657986402541e-13,0,4.18709511507132e-12,2.19380069665931e-13,0,0,0,3.77475828372553e-15,0],[2.70603780410006,3.19370780147798,2.11798315882765,2.97664390728407,5.34910556471999,2.01815008415903,2.7829915597874,2.61693441199105,3.03717322572076,1.99079778040391,4.54900509446901,1.36127705146346,1.3117213996891,1.8062661765002,2.76691270238076,3.09019922403307,1.26521372367672,2.73634620171989,4.50013733990266,0.91611915442921,2.22781606801698,1.49261968688747,1.9804167724157,2.81688770173037,1.67714772293384,1.30009381355543,3.95802493038609,2.5175655272045,1.76829525416884,1.31396241322094,2.30274118116641,2.95354022471066,2.20031016939573,1.55834549812751,1.67577103957987,0.812633444906939,1.83597642342225,1.93633129492358,3.97999892987868,1.66044330745633,1.32677039646183,1.2688639520419,1.1630693056687,2.14466613263523,3.79687685344358,2.3556025550785,3.64880553271529,1.05226135444361,3.34125990198495,2.05683142913847,2.68900282442031,1.06374495405707,2.6294102449449,2.75610706572824,1.21685114501074,1.97587825017064,2.94088953473474,3.43860193886723,2.35642651038658,2.2699581181971,1.72242345529657,1.87913361206401,1.9510220591043,2.77827085407911,1.42698415679616,1.27290500968709,1.46055583262611,1.90303427235907,1.54799935431644,3.89824939127419,4.48879460620482,1.04646875888151,4.79507359201393,4.23458501781753,2.19020211422886,1.35028919936679,3.70770381768967,2.83234723827625,1.41467587455009,1.56433768606007,5.76665904262597,1.53993421073451,3.2445033574057,3.22165645491236,1.12047364772137,3.13774137809471,1.37167634156216,5.61344410244503,0.821753849524032,4.79374502609236,1.18100228990875,6.95110070833968,1.05540198181012,3.42144033153471,1.75319117489472,2.76697356282866,0.873462304497979,1.16072105025646,2.50762152985109,0.88078049967853,1.47862331592869,1.80488836016091,1.21841129773994,2.88561532143981,1.6962903371944,3.76065884524584,3.62720113816708,2.69012448244615,2.88996621896147,1.17183274430728,3.49380377918849,1.13704013155918,4.45939265866821,1.20422226772241,3.06130064662565,3.32141778739384,1.08663277766871,1.71949339140828,2.97539179712414,1.22968131053166,1.16896627239621,8.83745292187405,0.957204641956413,2.57897771989841,4.72826116907024,1.43941215467311,1.52556335689023,2.20116399192015,3.60264584664609,1.88362438596142,1.32163769956481,2.01894105598824,0.921056997522579,1.18787885964153,1.90284468104722,0.998253902384822,2.69420845982909,3.01632660161641,2.18247306238964,2.93679105088628,8.24899409293169,1.50832509776008,2.93515543507863,3.0509796116449,3.83268074465211,1.74899559489008,2.54433299637496,3.86663547868837,1.60077113743724,2.21728898702909,2.41457357570864,2.41596734368561,25.6460371263325,1.67189946269441,4.88725044068654,1.5156293014378,1.08899236805444,1.64742211005874,2.33748744817907,1.18034783352539,3.56741869226814,2.41391714028267,5.50281221166861,0.569927407319904,7.07667974043541,1.17996640294757,1.20332241924026,2.50048222606532,2.78597393257393,1.03243330461193,1.02850826962534,2.32585305835188,4.18325130621765,2.72190991012511,2.57916595200992,2.23379879564775,1.39250681967782,1.79547518132387,1.01285778604513,0.979323739078522,1.38879548922634,1.52438530325564,1.42641030189721,14.7721869238045,112.931692880671,2.64995084546369,1.66646844684467,1.90774586724861,2.89485843957522,1.38728402036628,4.76419576643573,4.33305238581906,0.549463853836202,1.58197624749457,1.30677968307629,2.29391541012215,2.26153905580917,3.63137132485529,1.67070781552759,2.46343737167215,1.69315000765697,2.11132089196375,1.03496869544136,0.819677867131763,3.10134655785211,1.61383607430415,1.01646166035886,2.32421030445098,1.71849410137906,1.4047660120821,0.580020020900035,1.12836089125346,1.21880052958756,3.39015286373352,4.6533400840568,2.77245758316721,2.17421498940969,1.82795496550608,2.17164076198959,7.6407500859109,1.72254556841794,4.23310324993195,2.24055038252938,1.4777002314921,1.94754121562162,30.7441459128012,2.03480600958459,1.2472154841342,4.83100486492416,1.12111376406408,1.75797336711708,1.19173073535327,1.82770541749926,3.24985279392062,1.1605191850638,3.31447958081049,4.26859416794129,1.33069506880626,1.59443004202896,2.56611699111406,2.17368554494358,0.839953095509485,11.9175687120702,2.74043213365383,2.00017801560178,2.3756724969011,0.632098603192118,2.33263167509388,1.40491741470889,1.1040483567615,3.90565143585686,1.82118617842006,1.36519624712068,1.58280394636921,1.83350390775613,0.911954370602382,1.28222629873882,0.784443666286492,1.18961814030202,1.0932892554472,2.86570519199398,1.50099109807363,2.37026099426424,2.45847040513118,1.13683116936297,1.59861379149718,1.23082260871716,2.69492462326995,8.59647961206162,1.90884014557289,3.80156648595687,2.23755360545341,2.16887400251145,5.16203162492919,1.54308719765869,1.17838009819497,1.39725017525902,1.63764679020203,2.73183873738976,1.04380781679784,1.57191307040248,1.32758394992696,0.797779037724141,3.81906572465198,1.17009662349831,4.79737056051285,1.49963122360945,3.22362942299119,1.93849057260444,1.75527340689415,1.77720221890009,5.15149004360994,1.55658012728752,3.30752244251945,1.7198667730585,2.48094578242761,3.18987579458374,0.814223384594409,1.34612174390085,1.60254313568916,1.47634773445787,1.63383979874744,4.1180306705671,7.5961771329452,2.36693164749153,1.03225927896378,1.91735552377322,1.32904382361189,1.37370672371777,1.66346889847497,1.78535167112863,1.84698791862838,1.64638109270671,0.868213469585321,2.28950443682705,2.65299603524672,2.36611284765417,2.71031451625883,0.809823783878696,0.898058454402433,1.4948170073069,1.13668659664103,1.57629656319913,3.72268103849436,2.19986938981745,1.17217984554712,2.14642870267253,1.63306719733247,3.31512806456608,0.990045975603235,1.99949916546902,1.56205143063422,1.28450992243534,1.17488429002016,1.92705990968273,2.67241744089167,1.34680053007954,1.70448558849579,1.69318425814473,1.96974439880131,2.60458029443373,0.92333484082258,3.32398375555569,1.52126803558378,3.30794611179529,1.73230041896964,1.76534933640726,4.19899822035043,5.2517551816144,2.03205963684951,2.70313725419031,1.54292700163213,1.50183132155533,1.38318077605828,3.10195780850851,14.8131310350738,1.70370794220862,4.3461779748178,1.52935991878851,1.03510070254186,3.56678157524229,1.58472020308994,1.31744244326106,7.65012141279254,1.63663195921928,1.25984945812001,1.08376001046945,3.54181969977193,3.42725162465926,3.65804779587989,1.52347911154026,1.58151594434876,1.71037139359735,3.26184746217208,3.91925805162514,1.65604995856726,1.78162958163931,1.49179700942615,2.01873753014196,1.5885414097317,2.14206713098781,1.69985921355041,1.70310399615052,3.82649138519022,3.24716321185721,2.19097857328471,3.08328924513483,1.94880807185535,13.219068043869,5.1553347710692,1.77592710325227,0.622792170501686,3.08727581671415,1.10252875242676,3.1841207698266,1.79539990565084,2.2606542107938,2.65380146997714,1.73998500386468,1.77831386734055,2.48569276838832,1.57471587624471,6.14003359636341,1.80925071330357,1.81882624942498,1.77216504682837,8.02762199259221,1.69909888478417,2.30561006305226,0.951278230969376,6.67748054056352,1.83178241064218,3.80842994064798,2.23438644837865,9.29176469400734,1.83352400885869,3.60774708491467,2.31371995356249,1.82910716438748,6.50197242347688,2.03973276652037,4.90656926990978,2.46801782669048,2.71367173648341,2.04752596137074,2.06726454042705,3.66779969425262,1.41126776169884,1.69069308591379,1.27568446540868,0.935044067037838,2.15957948558303,2.53311011733385,3.90233908243665,1.63843241319744,1.60932589618748,1.10625320867358,1.1852909903588,1.017384051183,1.5569814064397,0.996509957734516,1.49991920910319,1.31960602330322,2.73818496700209,1.60325334424656,0.88804538102259,2.40454182692514,2.22570225232387,1.849464070149,6.70699386707149,3.06125389092984,1.47470228682667,1.88659564559863,1.0093807958893,2.07721296910185,0.521599714413937,6.47256276042606,3.5200594898954,3.18845750170374,2.29233118558557,1.17325116224586,2.20484641321691,5.092026768156,0.455515791626643,1.04764984745946,0.930526624126475,3.88548538532133,1.12953186081991,1.70680336237457,1.7663760855415,0.736923051961021,0.99984858777736,3.6627110021752,0.494584381245221,2.35969713082793,0.778011248459566,2.64263690545929,1.03249311034286,3.14078318303927,1.32056268284541,1.53588171885715,5.4330599029946,2.30732950094422,0.878553763194903,1.06386163890249,1.7662156520985,2.77390229343883,4.3972092908682,2.06093126236811,1.31407725123506,2.42933801346937,1.04443733342234,1.01098797563486,2.09405119385671,1.49808605497724,0.836495804130411,2.83628594134051,0.841098467106317,1.76222817658249,3.18261196711585,1.86697629471935,3.39864256645921,4.24043898948659,0.895843806456278,3.43826538046495,1.35903184815119,2.50120526273709,1.38622570734593,1.52560967314774,0.713191356981117,2.7695196397671,1.44158268542746,1.39139051850959,1.43388353772062,4.5545565733754,5.4199259014264,4.22814394225946,3.53661857652456,4.10272609360369,3.94621174396274,3.96936881159298,3.663214423349,3.62564862117061,3.84001243316495,4.34041958850672,2.96010542224306,3.71765073997635,4.54849511623655,3.83181165887896,3.73786233279953,3.41016323296394,2.80045429474698,3.13647850635658,4.28579540311954,3.05592030233704,3.3931490185298,3.9239569250999,2.95305622622434,3.34879332267217,3.25636463476734,3.56039625738298,3.57703445061269,2.96475678353181,3.07601605095466,3.49175380109026,4.13388101006372,3.10075450938963,2.9088755638495,3.02604528895713,3.40377682371436,2.72428020175495,3.32493436031125,5.30929475987343,4.21572254985697,3.08904897654058,3.16333425990004,2.933261602812,3.04819439366753,3.20534175463524,2.89168507180169,2.79980705072249,3.3133566212467,3.01677576639575,2.71353428668769,2.25989157560068,2.40877743288658,2.82860979107352,2.98257719815556,3.20017543827011,2.40427527050084,2.93417880847191,3.66455452837732,4.18572844861453,3.65148650918704,2.90224283088056,3.09555143680139,3.30563755314433,2.30659104805246,7.16766793702142,2.63619654154845,3.52465783711642,3.58076364839364,2.41926830464259,2.57347466168994,2.55256893773999,2.456825679773,2.19676607005717,2.36887033301279,3.23260638379156,2.50463637614161,2.06338228345439,1.91487447621026,3.40280610240173,1.4352685021562,2.20150126669831,2.10993467309879,1.21834979694501,2.31814406459165,0.78279892327708,1.40186335542472,2.80429021064162,2.47531336366307,2.48793342333615,1.32013645411667,1.96929871342496,2.53975654057972,2.51924848705684,1.53358374544925,1.07286883544153,1.13400665494319,1.56781892988291,1.23706109448059,1.51196995322073,2.81855651243801,1.75615214229983,1.49679271258894,2.99549269608038,1.53552685603473,0.716079507106066,1.22394756082082,1.80738968448283,1.96676353018817,2.25251249028347,1.30419370759557,2.24657982364379,1.44940346179019,0.90681569382657,1.20079409894198,0.810314546248037,1.23346357290006,1.63122941714208,0.969812117068617,2.10563684630925,0.558568911336541,1.24370574414071,1.16231655622042,0.696034863365901,0.491539892950001,1.90526134969753,1.46147773443623,1.49543126872601,1.79293250272918,1.23304098164307]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>waldStat<\/th>\n      <th>df<\/th>\n      <th>pvalue<\/th>\n      <th>waldStat_1<\/th>\n      <th>df_1<\/th>\n      <th>pvalue_1<\/th>\n      <th>waldStat_2<\/th>\n      <th>df_2<\/th>\n      <th>pvalue_2<\/th>\n      <th>waldStat_3<\/th>\n      <th>df_3<\/th>\n      <th>pvalue_3<\/th>\n      <th>meanLogFC<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":8,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":9,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":10,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":11,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":12,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":13,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render","options.columnDefs.4.render","options.columnDefs.5.render","options.columnDefs.6.render","options.columnDefs.7.render","options.columnDefs.8.render","options.columnDefs.9.render","options.columnDefs.10.render","options.columnDefs.11.render","options.columnDefs.12.render"],"jsHooks":[]}</script>

## extracting candidate from each lineage
lineage1Genes  lineage1 lineage2 lineage3 
#&gt;      305      588      588
<p><strong>(b) Visualization</strong></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">UpSetR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/UpSetR/man/upset.html">upset</a></span><span class="op">(</span><span class="fu">UpSetR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/UpSetR/man/fromList.html">fromList</a></span><span class="op">(</span><span class="va">DEgenes</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/plotSmoothers.html">plotSmoothers</a></span><span class="op">(</span><span class="va">slingshot_umap</span>, <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html">counts</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span>, gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lingo2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-23-2.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Interpretation:</strong></p>
<ul>
<li>Based on the upset graphics, we see there is a large overlap in DE genes between the three lineages (around 97%).</li>
<li>From the pseudotime graph, we can check whether the expression of an identified DE gene indeed change over pseudotime within each lineage. As an example, we select <code>Lingo2</code>, a gene that has been found to be differentially expressed for all three lineages.</li>
</ul>
</div>
</div>
<div id="which-genes-exhibit-different-patterns-of-gene-expression-across-the-pseudotime-between-lineages" class="section level3">
<h3 class="hasAnchor">
<a href="#which-genes-exhibit-different-patterns-of-gene-expression-across-the-pseudotime-between-lineages" class="anchor"></a>4.2 Which genes exhibit different patterns of gene expression across the pseudotime between lineages?</h3>
<p>We will identify genes that demonstrate different differential expression patterns across lineages using the wald test implemented in the <code>patternTest</code> function. This is accomplished by testing whether the expression pattern of each gene varies between lineages. As in Section 4.1, we will only focus on running the pattern test on the Cepo-selected gene.</p>
<!-- Whilst the `associationTest` looks for genes that show differential expression across a pseudotime within a lineage, we can also look for genes that demonstrate different differential expression patterns across lineages through the `patternTest` function. For each gene, we can test whether its expression pattern differs between lineages. Here, we will only focus on perform the pattern test on the Cepo selected gene. -->
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patternRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/patternTest.html">patternTest</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">[</span><span class="va">cepoGenes</span>,<span class="op">]</span><span class="op">)</span>
<span class="va">patternRes</span> <span class="op">&lt;-</span> <span class="va">patternRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">patternRes</span><span class="op">$</span><span class="va">waldStat</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">patternRes</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/ggpubr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/DT/man/formatCurrency.html">formatSignif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">patternRes</span>, <span class="va">is</span>, <span class="st">'numeric'</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f8efcccfd2ba7640474c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f8efcccfd2ba7640474c">{"x":{"filter":"none","vertical":false,"data":[["Sema5a","Prox1","RP23-231J2.1","Syt4","Ntm","Lpl","Trps1","Lrp1b","Mpped1","Zfp536","Runx1t1","Cntnap5a","Adamts18","Cntn2","Cntn5","Pcdh7","Pde1a","Pvrl3","Camk1d","Zfp462","Nrip3","Vat1","Fbxl7","Cpne4","Kcnt2","Mgat4c","Lypd6","Rprml","Lmo1","Clmp","Nbl1","Kitl","Tgfbr3","Masp1","Maml3","Pex5l","Nr4a2","Rgs6","Hs6st2","Aff2","Syn3","Lsm11","S100a10","Akap7","Calb2","Actr3b","Sulf2","Ntng1","Sorcs2","Cdh13","Col11a1","Pdlim4","Elavl4","Vim","Spock1","Lrrtm3","Tmem132c","Btbd3","Tspan18","Wscd1","Nts","Spats2l","Prox1os","Sertm1","Bcl11b","Cntn4","Camk2a","Crim1","Timp3","Kirrel3","Ptpro","Lxn","Hs3st4","Adgrl2","Nrg2","Tbata","E130308A19Rik","Tmem191c","Ak4","Cdkn1c","Rbp1","Sema5b","Gfra1","Me1","Kcnip1","Tmtc2","Ptchd4","Plcxd2","RP23-291B1.2","Gm11837","Pcdh19","Lmo7","Bcl6","Adamts17","Tnr","Gad1","Glra2","Tiam2","Prdm5","Il1rapl2","Gm30382","Arhgef26","Luzp2","Adora1","Necab3","Chd7","Arhgap15","Kcnip4","Ldlrad4","Myo1b","Pvrl1","Slc17a7","Ube2ql1","Klf6","4930590L20Rik","Ntf3","Snx7","Chsy3","Fam19a1","Grid2","Unc5c","Atp2b3","Grp","Cryab","Dock10","Tmem132cos","Kcnc2","Shroom3","Nptx1","Sv2b","Raver2","Glis3","Vcan","Prkcg","Rasgef1b","Ctnna3","Ror1","Grik3","Nat14","Dusp14","Nefm","Rcan3","Ldb2","Rbms1","Satb2","Efnb2","Pappa2","Gm14964","Thrb","Bmpr1b","Gm15398","Ppp2r1b","Palmd","Ociad2","Sdk1","Flrt2","6530403H02Rik","Fez2","Antxr1","Sorcs3","Neurod1","Itpr2","Tgfa","Ccbe1","Cygb","Tshz1","Fam19a2","Pcsk2","Satb1","Ptprt","Nt5dc2","Ankrd29","Rspo3","Brinp1","Trpm3","Dok5","Rgcc","Syt2","Col19a1","Cldn3","Insm1","Chodl","Adam12","Rnase4","Dap","Samd12","Bcl2","S100a11","Xylt1","Car12","Nefl","Etv1","Gm11713","Gab1","Pde7b","Pls3","Plekhf2","Gatm","AI593442","Plcl1","Tmtc4","Nos1","Fhl2","Ezr","Spon1","Gm42477","Gsg1l","Grin3a","Nrsn1","Man1a","Trhde","Ifitm10","Gm11417","Nanos1","Fam84a","Fosl2","Rph3a","Hebp1","Ryr2","Tmem141","Chst8","Lingo2","Cap2","Dlc1","Stat3","Nhs","Tbc1d4","Scube1","Adcy1","Calb1","Ntsr2","Vsnl1","B3glct","Tox3","Bcl6b","Agbl4","Ank1","Itga6","Nell1","Crabp1","L3mbtl4","Hist1h2bc","Krt1","Kcnab2","Sema3a","Zmat4","Pkib","Inhbb","Kctd16","Xist","Snhg11","Gcnt2","6330403A02Rik","Epb41l4a","St18","Adamtsl1","Col12a1","Kcnmb2","Cntnap5b","Sipa1l2","Dtx4","Hs3st1","Bves","Met","Vat1l","Btbd17","Tmem163","Fam210b","Rasl11b","Serping1","Dusp15","Car10","Acot1","Ptk2b","Nhlh2","3110002H16Rik","Gabrg3","Myo5b","Tox2","Fam131c","Cxcl14","Nebl","Kcnip2","Triqk","Mir124-2hg","Lancl3","Iqgap2","Mid1","Slit1","Nwd2","Itpripl1","Kctd8","Abca1","Slc1a3","Insc","Myc","1700001L19Rik","Me3","Adap1","Fam181b","2010300C02Rik","Spock3","Dkkl1","2600014E21Rik","Klf3","Ildr2","Fzd7","Kcna1","Gpd1","Bdnf","Adgrg1","Bmper","Ccdc85a","Gpr158","Mdk","Scn1b","Iqsec3","Sgk1","Rai2","Syt17","Lin7b","1190005I06Rik","Rmst","Cmtm3","Pcnxl2","Arhgap28","S100a16","Gpc6","2900055J20Rik","Tmod1","Kcp","Slc6a15","Slc12a5","Cdkl2","Lin7a","Gabra3","Cdh9","1700111E14Rik","Grb10","Ptprr","Ppp1r16b","Prkch","Ablim3","Syt9","Gm20642","Sowaha","Cntn3","Fstl4","Lama2","Ptprn","Ttyh2","Adamts2","Plekhg2","Deptor","Grm1","Antxr2","Ano3","Abcb9","Mfap4","Kcnj6","Nrg3os","Tuba4a","Shb","Cdk2ap1","Rarb","Gucy1b3","Faah","Fam163a","Gm11817","Disc1","Arhgap6","Tmcc3","Plcb4","Sapcd1","Gng4","Syt13","Cdc42ep3","Gm13703","Glipr2","Fam163b","D030025P21Rik","Gm13944","Rgs12","Phyhip","Lef1","Cdh20","Eya1","4930578M01Rik","Tmem200c","Afap1l1","Gm11266","Prrt2","Rpa2","Rftn2","Aif1l","Tcf7l2","Tox","Rasgef1a","Ypel2","Csgalnact1","Ebf1","Pfkp","Sidt1","Tead2","Chst1","Cdk6","Celsr1","Scgn","Adamtsl3","Pax6","Rasgrf1","Gsap","Zfp423","Clic1","Tac2","Kif6","Megf11","Diras2","Dnah9","Kcnh8","Itgbl1","Parm1","A730004F24Rik","Dach1","Efhd2","Ascl1","Popdc3","Atad2","Nov","Rrm2","RP23-407N2.2","Adamts19","Sox6","Tpbg","C1ql3","Lig1","Akr1c19","Cidea","Trpc7","Cpa2","Cnnm1","Calcoco1","F13a1","Chrna7","Daam2","Gm16183","Shisa9","Nkd1","Mcm6","Phactr4","Galnt9","Gal","Egfr","Gm11659","Zbtb16","Pla2g3","Nhlh1","Gucy1a3","Dpy19l1","Zic1","Ctnna1","Rnf122","4930545L23Rik","Gm38399","Cpne6","Neurog2","Thrsp","Tmtc1","Ppp1r14a","Gfap","Mfge8","Atp1a2","Neto1","Eomes","Il1rap","E130114P18Rik","Mfng","Nxph4","Crip1","Mlip","Fndc1","Phf21b","Loxl1","Mms22l","Efna3","Myl9","Hmgb2","Jakmip1","Clic4","Vstm2b","Rhbdl3","Tcf19","Veph1","Gldc","Cd164","Scrt2","Zfp521","Lypd6b","Afap1l2","Dhfr","Adgrv1","Itpka","Cenpm","Zfp367","Klk8","Slc26a4","Ung","Cntn6","Gm27247","Myo10","Cgref1","Lockd","Trp53inp1","Serpinh1","Fam81a","Hmgn2","Npy1r","Baz1a","Arhgap31","Fgf9","Dtl","Kcnj10","Prss35","Tmem114","Foxo3","Hells","Arhgef28","Efs","Gm13589","Fbn2","Inppl1","Phgdh","Dmrta2","Lgals1","Asns","Notch1","Gli3","Slc15a2","Phldb2","Sox9","Acads","Msn","Mcm4","Pcdh1","Slc25a18","Capn3","2810417H13Rik","Kcne1l","Chaf1b","Clspn","Gins2","Gm17455","4921534H16Rik","Gas1","Prom1","Cdt1","Rmi2","Gm1043","Msx3","Tfap2c","Gm29771","Myo1a","Slco1c1","Trpc4","Cd1d1","Fam135b","Matn2","Rimbp2","Rit2","Rnd1","Cdh11","Gda","C1ql2","Zfp36l1","Fam159b","Myh7","Gmnn","Uhrf1","Rfx4","Sox2","Ccdc109b","Tk1","Mcm3","Neurod4","Rasgrf2","Id1","Zcchc24","Top2a","Tmem117","Cdkn2c","Ccdc184","Cdca7","Cmtm7","Mcm5","Dbpht2","Col25a1","Sox1","Grb14","Mcm2","Ccne2","Pou3f1","Csrp1","Ndrg1","Bcl2l12","Scn9a","Cx3cl1","Otx1","Gpr22","Ctxn2","Gm9866","Rspo2","Kcnc4","Cdk5r2","Slc6a7","Mal2","Slc30a3","Xkr7","Chrm1","Dna2","Pon2","Htr4","Adra2a","Npr3","Gm42722","Tacr1","Eya4","Rasl10a","Icam5","Arhgap24","Npnt","Avpr1a","Grem2","Ddn","Dgkg","Gm43507","Kcnj4","Gabra1","Cdhr1","RP24-236C17.2","A230006K03Rik","Sla","Hcrtr2","9530059O14Rik"],[12442.3239442048,9266.77673985621,8114.65358898268,7343.23023522385,6663.33417836841,6492.01909755537,6292.23383839045,5574.54482592995,4436.71647733202,4321.64134821803,4131.72442630594,3807.3680458468,3688.4788687974,3585.25739084316,3418.92941111806,3294.5776950141,3269.78631128037,3237.55082056251,3167.43208669221,3161.93369309392,2680.57134231469,2677.41342404465,2668.77031291682,2621.48140440506,2468.76109967781,2423.18915064137,2352.59774571984,2329.01247653179,2322.05624109481,2258.76381454452,2219.28842230926,2155.80861777107,2112.62888875761,2103.60641024156,2087.42171976611,2077.60759320284,2055.80496276029,2017.53270060266,1991.40389375057,1975.46581633486,1968.80969881267,1953.93238164544,1923.08635830244,1916.51010368028,1891.1726469206,1887.70955033206,1872.7226890058,1841.60482636692,1776.44285665767,1738.14600638742,1693.7358063161,1615.90714904404,1586.26899125941,1556.94840013358,1555.2721770863,1534.62531110452,1491.52236803466,1475.69687328796,1470.21422475385,1467.82354303039,1463.5813233793,1436.27662864521,1421.01712708046,1386.74382788489,1380.32406037264,1358.15913326698,1331.63003821557,1325.61216465756,1319.72333267475,1272.69454469517,1266.34326401189,1254.65612073413,1247.45840595191,1241.53156873158,1236.74978741545,1215.49017705304,1198.82539922581,1179.17988736746,1169.69059352996,1165.92278497376,1139.83642533728,1129.05715457078,1128.67347973168,1115.76633363021,1112.62652302924,1094.66231421853,1080.31195749625,1075.79066619597,1072.17457533486,1068.93824144713,1066.86119664116,1066.33004209058,1059.04537231141,1059.01142478413,1039.48678063921,1024.14408966348,1018.84945859837,1013.34684408354,997.665110401233,988.23249803611,987.001343463858,978.21307675094,978.008233339274,974.140950276438,972.623663868791,967.618887600247,956.016190143327,953.175701789942,949.339194491412,935.712613781035,925.828111901679,920.02620164332,919.593692728029,918.763281227869,914.791247956469,911.092786455548,904.82938550226,897.158403650345,893.28371144007,891.120876150005,884.866199009549,879.947875016312,879.348047330977,872.20205669158,868.047119813792,863.083349622752,860.093567773798,859.679369153238,850.963606759378,848.799210506505,847.92954155502,838.706265037951,836.394726200734,832.051170714045,826.726274103607,821.533779490976,818.131788548669,817.256601812422,811.883791331273,811.189798906998,808.342632596094,807.48188043336,806.724155607196,783.52821793696,780.119341434216,771.658148249402,770.758989663457,770.59820797315,766.918805010329,765.897679775628,758.836758082003,754.629075387291,724.173018145586,722.711079146782,713.357489532938,708.653188763353,704.238077311089,696.800452083251,694.61297258608,691.053787300885,685.622009199741,685.476404845327,680.111491324589,679.583495942789,679.189357001473,678.072538733416,675.302017887493,670.830396144813,661.520761171838,657.015384869684,655.55729279874,651.742869225994,649.212689455464,645.299609018641,623.217122927915,620.359426173897,617.749790897888,614.365946341652,607.847618379463,607.765729251735,606.759766174175,602.465829410149,593.360482918218,592.806404219744,588.099266975082,587.227725567446,584.770404373569,578.955388241499,576.773424820741,576.108333135679,570.883429111195,569.189018536737,568.804607475344,566.756714012431,564.751758220912,561.700100195871,557.170678022095,544.199109060044,541.034340379769,537.041697722792,534.914708671585,531.706738404603,528.472575684387,526.288283680847,525.834286849379,521.529537925678,519.970525209982,517.99189903519,516.605036131653,515.595748520213,507.874166444518,507.237650563181,506.425296277603,498.087155160245,496.703437606108,491.291395239163,490.047605072143,489.36537993902,478.65320612203,478.600097204313,476.711957697004,475.682055266983,467.84861254768,465.089700616171,459.010285189698,458.453274129341,455.729966017829,451.766035842073,450.582447437047,450.02477649541,448.019348895597,446.440384865421,446.353188420886,440.172728781012,431.930286221039,431.56256799062,421.623870521098,420.932304118751,420.297737372878,419.142950501393,412.316719062052,410.248420126218,408.280962315712,405.149028671489,401.999093333719,399.102689678501,398.672008705328,397.711247442178,392.738932548777,392.104491732673,391.494716227279,391.412857076357,387.470351393686,385.712156678994,383.83391581343,379.555649508826,378.057463648396,377.151150647364,373.109576580969,372.516382164578,370.718517748983,369.668445645572,367.452299814983,363.513956632186,362.946777052928,362.03705826788,361.911849601848,354.911213176802,353.870051173134,353.65775490606,340.237740320838,335.470383264179,335.342846196974,335.270200246844,334.124387765819,333.695661771125,332.268717421972,331.203646426437,329.160706237718,328.685748446867,325.998399914328,324.598847316451,323.339767205256,318.665947857351,316.288133590158,312.786908045728,311.815913417428,310.064202509904,309.444261263515,307.064151176933,306.143782659579,303.15067709083,303.061201089866,297.753585862024,294.25537710797,292.30978089093,291.514040877665,286.203171456554,283.193718653432,282.978753846383,278.236275386789,276.901305149037,276.655554759999,274.983994544553,274.43759405563,273.424635900933,267.202323877381,263.378707518876,262.445519791308,259.75624975468,258.907760694031,256.452164108735,254.700490843198,253.193601992961,250.629100712826,247.209862425769,246.359394333141,246.273029025613,245.382437015896,245.345186382737,245.267221882289,241.775829934729,238.876889108994,237.07651834753,236.349354406582,234.756899907624,231.124073503837,231.100473064627,227.774780722863,227.495734982596,223.075803277594,222.4640172017,220.619676879167,219.9767508453,218.049727821715,216.738764070769,216.433880381409,214.735692150799,214.207556971389,213.263234696281,212.904429193198,210.760716890419,210.125061572506,207.663281012033,207.203343262358,206.90682220736,203.466778510011,201.10942284106,198.952337718506,198.134607885458,196.365468448917,194.876360734791,194.450158342792,192.916659933207,192.292290239915,191.982683293508,189.728287463022,188.948203127348,186.957130600663,186.420037034756,185.834941964761,182.317403858025,181.999751406402,181.97419505313,181.97227171393,181.582142187022,180.758785375717,179.771627542414,177.76007765852,177.689022274452,169.863382013313,168.135643517355,167.004010726078,159.743114119914,158.294891344102,156.378500443442,153.74731414653,153.699673868484,150.001967420406,149.915037221293,148.628983078872,148.06999936851,147.895541774163,146.139587176971,145.479598047243,145.117770449879,144.567908807706,143.217921752996,139.697296305745,139.313568440821,138.949334797199,138.715932827923,138.332138279635,137.909460204706,132.719151916012,129.315015039049,129.148901166211,129.027937417127,127.461844489744,127.19206749687,126.660728110111,126.339979551484,124.609946958271,123.171737808507,122.834599739324,122.025756023753,121.369602461821,119.851482892242,117.803136227337,117.243743994644,116.452472311372,115.319759704458,114.410068437838,114.377776183967,113.700682540181,113.593838204502,113.371480608913,112.513761791526,108.717929708591,108.134281081277,108.083073582546,107.985998576077,107.51026962793,106.045228503571,102.304386223709,102.201357849189,99.8973906479761,99.2618295453662,98.4985574450755,98.0248524044266,96.4909940400882,96.3433945968665,95.1904671826285,92.1276237036918,91.3239507072426,91.2525876247095,90.5380375005543,88.8525654163758,88.5995998541651,88.4814393100934,87.7805451583039,87.4314510538398,85.2057152407366,83.7223172489293,83.1827999653004,83.133016914151,83.0319213482495,82.9969457382892,82.4369601932556,82.0904852242258,81.9024466020792,81.5544463876202,80.6279772561671,79.8178518195896,78.9779061285639,78.022958988658,77.8596606197252,77.7071303856468,77.6147492646483,77.5260422370711,75.7674864517807,75.4874656593435,75.4271076865569,72.6187320522415,71.3368434830363,70.7823894508313,70.7720315335059,70.6127407342652,70.2751857501962,68.7725552232966,68.3351164148494,67.8572699562404,67.3646419311854,63.4542064150552,63.1132644412406,62.1432503007584,61.6199762480654,61.2105351132137,60.9935793494186,60.2939252523956,59.7798454133826,59.5436350619425,58.1957791192023,58.0869046039204,58.0830032842841,56.9324214879451,56.0140007280846,55.8751500790598,55.8530050895068,54.7665789211709,54.240427079814,53.898338661626,53.4293915435631,51.778900812572,51.4600088503684,50.9518146248585,50.829526456491,49.9923406648901,49.9534797390156,49.8106611489966,49.7632706759014,47.9445493646074,46.3125895544338,46.3016455059225,45.5910011041218,45.5817895726264,45.0669965293388,44.9880049625966,44.9299434030876,44.7557579433381,44.6024079749503,44.2922205472078,44.1053387317964,43.8953926805445,43.2292304253948,43.1293986054592,43.1226869527082,43.011609280355,42.7844167022418,42.1273512201665,41.9082573846425,41.4532583242731,40.5490590648021,40.4197349805675,40.3238174873804,40.1134984386488,39.7294852836096,39.5960467936546,39.0564807349435,39.0100398470071,37.6337397097574,37.2762175115597,36.52756615147,36.3088227947082,35.996050526344,35.8986601699613,34.7846330581836,34.6759586024671,34.636709976103,34.4636083650036,33.7274021163683,33.4493722125259,33.058797406369,32.4827434580251,32.0891586211121,30.9444109066153,30.9028105228315,30.5268507189355,30.3710244253254,30.2391644202303,30.1235647252797,29.4306300351565,26.8831502391954,25.4434977329233,25.1738854706657,24.9632446182685,23.0493444199598,22.9286859363475,22.41990555199,21.426066131836,21.1780140718823,21.053695810057,21.0533374305796,20.4732086968217,20.2857878438922,20.0323310320909,19.8736119628417,19.8452309392381,19.534843709277,19.1405869016557,19.1391444929213,19.051721482004,18.9958728858228,18.5358242096769,18.3716215053036,18.1951477133516,17.8282323701657,17.7396305850635,17.718285725001,16.8701336662098,16.0698841796643,15.5772236238558,15.3902016043962,15.2750057043457,14.5970914634153,14.5589456921548,14.2541477491452,13.1891578582655,12.4301949453747,12.2680167565891,12.1141176051296,11.6785629583279,11.4457089755743,10.8809685961556,10.6447114471318,10.517478010969,10.0693514367903,9.82500018225865,9.72610871793676,9.67027617205358,9.10636390504305,8.7989389531063,8.77059883998609,8.73302850795524,8.62592525799355,8.56469403395434,8.55562807048199,8.31727157377001,8.17916707849893,7.92686055266528,7.74339560889585,7.62495159498583,6.79931922934283,6.65471728628147,6.63999790158093,6.43415221496158,6.34870438569629,6.20210580331284,6.11178723747954,6.10767150557045,6.04942126598917,5.63747316339753,5.04357323902664,4.87176554660764,4.20882411694298,4.14912468901149,4.11521329660665,3.72289157796375,3.53547727258196,3.24746613432177,2.67007219992143,2.6561596649468,2.59399188915206,2.49118713668451,2.20800834941832,2.18106947867688,1.71270504241087,1.60765222109923,1.40569436892075,1.30914518527403,1.18693247866544,0.671986745159634,null],[12,12,12,9,12,10,12,10,12,12,8,10,12,12,12,12,12,11,10,12,12,12,12,9,12,9,12,9,9,8,12,12,12,13,12,12,12,8,12,12,11,12,10,12,12,12,12,12,11,12,12,12,12,12,10,10,12,11,11,13,12,11,12,9,6,12,9,10,12,12,9,12,10,13,10,12,12,11,12,12,12,12,12,10,12,13,12,13,12,12,8,7,13,12,9,12,10,9,12,13,12,12,12,12,12,12,11,11,11,12,10,10,12,12,11,12,12,12,8,12,9,11,6,12,11,12,11,12,11,11,12,12,13,10,12,12,12,12,10,12,10,12,9,13,12,13,12,11,11,12,10,13,12,10,12,12,6,11,12,12,12,12,11,8,9,12,8,9,13,12,12,12,11,11,10,13,11,12,10,12,12,12,12,11,12,12,13,12,13,10,9,12,12,12,12,12,13,12,10,13,12,10,10,12,10,12,12,9,12,10,10,11,8,12,10,12,11,12,6,11,9,8,13,12,13,12,12,11,10,9,12,11,13,13,10,12,10,12,6,9,9,13,8,12,12,12,11,13,7,12,10,11,9,10,9,7,7,11,6,12,10,13,12,12,12,12,13,12,12,12,10,9,12,9,12,12,8,7,12,7,12,9,7,7,10,11,10,12,10,10,12,10,12,13,12,9,10,10,10,12,9,7,9,13,12,11,11,7,13,7,13,12,5,6,13,8,10,8,12,11,8,11,13,12,6,12,12,13,4,12,10,7,10,10,9,10,6,12,13,5,7,11,6,12,5,10,11,7,12,8,12,10,12,12,6,12,7,13,11,6,5,9,13,12,10,11,6,5,13,12,12,10,13,8,8,10,7,9,10,6,12,12,12,6,10,13,13,12,12,12,12,8,13,12,13,12,10,7,13,11,13,7,6,12,6,13,12,10,12,12,8,12,12,12,12,12,13,7,8,12,5,6,12,13,13,12,10,12,8,13,6,13,12,13,7,13,6,9,3,8,7,12,12,7,12,12,5,12,12,11,8,6,13,7,9,7,10,11,13,12,12,12,12,12,10,12,13,7,12,13,13,13,9,5,9,12,12,13,12,6,7,12,12,13,5,12,12,6,12,5,13,12,10,12,13,12,12,6,13,13,13,7,13,13,5,8,13,7,7,13,8,12,12,13,8,12,8,11,12,5,12,12,5,7,12,13,6,12,12,5,10,13,12,12,8,12,12,13,12,12,4,12,13,6,12,6,12,12,12,10,12,6,5,13,12,13,9,4,3,12,10,12,12,6,12,4,7,6,4,6,4,6,6,12,12,5,12,12,12,12,3,9,13,12,5,12,12,12,6,10,4,12,12,12,7,4,12,5,13,12,5,12,4,12,3,3,12,4,4,4,4,4,5,6,4,5,10,4,12,12,3,2,4,4,2,12,3,4,4,3,3,4,4,2,3,2,4,4,4,4,3,4,null],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.11022302462516e-16,5.55111512312578e-16,2.22044604925031e-16,1.11022302462516e-16,7.7715611723761e-16,0,3.99680288865056e-15,0,8.43769498715119e-15,4.88498130835069e-15,5.47339951140202e-14,1.11022302462516e-16,8.04911692853238e-14,0,2.77555756156289e-15,0,9.99200722162641e-16,3.33066907387547e-16,1.54876111935209e-13,4.15556478117196e-13,2.44249065417534e-15,1.01629815674187e-12,1.03883568414176e-12,2.22044604925031e-16,1.10322861957002e-12,1.41231470962566e-12,5.80979708786344e-13,2.02060590481778e-14,1.66533453693773e-15,8.40427727410997e-12,1.49880108324396e-14,2.57904808620424e-13,3.48610029732299e-14,1.31716859641529e-12,4.08884037739199e-12,3.09272607523781e-11,1.22049037543093e-11,2.63012944756724e-11,2.97147861871849e-11,3.05063752037427e-11,1.03332231660147e-10,2.44548825634183e-11,2.28589924766709e-10,5.78479597557191e-10,1.11077813613747e-12,2.84484991119882e-10,1.34950983721183e-09,1.62335622722054e-09,1.98590810462917e-09,4.99241759044367e-11,2.34401387189109e-12,3.35403260720568e-10,9.15523745703695e-09,1.14178928534159e-08,3.18812117816591e-08,1.48666785548812e-08,3.92273991067782e-11,1.67031721787225e-10,2.73355590385549e-08,4.80344999331805e-08,1.15188238059005e-07,3.02385894102031e-11,8.12937668293046e-08,1.19003019438679e-07,3.08516212577103e-10,1.27208149569569e-07,1.45796263950615e-10,5.49011109796105e-07,2.84929509097864e-07,6.19629419995604e-08,6.78464095571485e-07,1.67128451922238e-06,9.49906076019857e-07,9.98266326601716e-07,4.71771899324125e-09,3.03675970958484e-06,3.2129030319572e-06,3.27355104012828e-06,3.65059170670534e-08,1.26150198090924e-05,1.26685826618012e-05,1.10009382714438e-08,2.85417897094575e-07,2.03957205094918e-05,1.37495448693237e-07,1.41109907314529e-07,2.29839479790606e-05,4.37678614573223e-07,1.36164426116636e-05,1.46532716031045e-05,3.19385181778431e-05,7.95285441057558e-07,2.14684780869279e-05,8.32910658554731e-07,1.0810515799542e-05,2.45583266149652e-05,5.55101280497183e-08,3.45100051964975e-05,4.11473730331791e-05,1.15715596216148e-07,1.04608925377558e-06,6.35292121509146e-05,0.000132538972413054,5.14806966389614e-07,8.38941928416048e-05,0.000103002502250149,2.36381190177326e-07,4.39456488198209e-05,0.000374943178449549,0.000266404142124088,0.000288955146648617,1.75894238081398e-05,0.00033636997275599,0.000506750424117519,0.000949293704928245,0.000534915555242543,0.000569812273132131,8.47537900749984e-07,0.00082336386296944,0.0016697049923271,1.3183600399258e-05,0.00134061330701329,2.59763247084654e-05,0.00203835264801733,0.00232487422555272,0.00245467719541548,0.000782768857213512,0.00267526294137821,5.04186260961159e-05,6.01101410675486e-05,0.020171941979331,0.0140200410889618,0.0233417349566214,0.00608644288995419,0.000130848425395458,5.33398176578714e-05,0.0444788350850476,0.019885896325312,0.049599666857838,0.0496048416403638,0.00228016093171779,0.061869291431899,0.000492113228031998,0.00584924631210004,0.00295060603200836,0.000616842536904527,0.00393267563228394,0.00073798067743891,0.00407716935681479,0.00417060877173403,0.100363170535394,0.104863895608377,0.00271151632382272,0.121006384859315,0.123827969208223,0.124515914779166,0.154548098493789,0.0010971799989723,0.0762526078559583,0.283630464345898,0.226740617080687,0.0122300375350343,0.266446540013245,0.284774208173646,0.355443175330753,0.0530316728532076,0.26751955906367,0.0165225289566114,0.471827655222949,0.491156000085562,0.539146360012795,0.154884854670917,0.03255708471986,0.609876440746752,0.0803483907841962,0.716163338569798,0.644861914467408,0.104896130133546,0.720001030777351,0.0670962912622269,0.725548340561221,0.034700920357465,0.0356749648176842,0.740343617031785,0.0806236196419031,0.0852312156452347,0.0942944272874346,0.101443295365145,0.106324012336607,0.23599811650585,0.35396168822664,0.156180359111421,0.266235039401234,0.785165392406567,0.184554741865216,0.910342284524378,0.910557307486615,0.10923037383934,0.0596812975401331,0.282855759135007,0.300710014085577,0.121917333464697,0.980592554232707,0.249288922932907,0.444805233007675,0.472504491487911,0.355021562102783,0.445337192172336,0.616907607579941,0.627887802822383,0.287770046237386,0.530372699173874,0.336036753582657,0.78840846337822,0.80741613682561,0.84320470612116,0.859822015956158,0.756140119104558,0.954738060691983,null],[1.54577578561849,1.82017519730354,0.934395922118318,1.18804266599758,0.887697188435419,0.669648242537937,1.48563279935683,1.20718487171158,1.12785693083978,1.42216541655016,1.56221357258834,0.785819837458642,0.828604304238766,1.09424822961513,0.565350321717808,0.858680010300996,1.04593242796725,1.03817194845722,1.27643515749352,1.04510300072453,0.84826549750739,0.653267690542228,1.06142535670354,1.45011456258406,1.13679813799049,1.6121654054821,0.500720177837934,0.841536444220535,0.904533965102427,1.13645718426747,0.646833056205632,1.40152868137857,1.53506232079228,0.678089617099337,0.825001061217685,1.05160384788738,0.605138264347327,0.695660763324516,1.78675345110357,0.833061550640198,0.949344546720498,0.808010617946471,0.664263077868767,0.599697599831886,0.603453359915301,0.35164944554765,1.00463147769988,0.757572362205578,0.883739284619493,0.592968144120388,0.695875414622818,0.890523774630844,0.482455891032456,0.526027429545832,1.19795549137954,2.07152246456053,1.00866430595745,0.45032972268227,0.51664449923408,1.08001324057142,1.24684823948731,1.40945519166157,1.10478566573962,0.988326506362092,1.05847157493353,0.610870072911639,0.984447088799357,0.871631387166608,0.830950185676026,0.690692274463798,0.922683667116344,0.755026622343858,1.38268472530822,0.643052794736833,1.2267075766697,1.68317433944711,0.970026810203024,0.652591412512403,0.909014493162652,1.00925602437341,1.41350948891355,0.814255088334343,1.38256906330396,1.15475753191697,0.521558984143011,0.347554554234395,1.86322240719259,0.523476683919689,1.42841703870415,0.656272851330761,0.787524569211339,0.680435187724984,0.850357834675376,0.695505249545554,1.15593140398313,0.836015239044614,0.536717612707782,1.11613499228422,1.14674290646034,1.13610286534682,1.9472522302754,1.09402946082892,1.14305806611981,0.783976350180758,0.711086922953431,1.00968204136092,0.886566018315026,0.886018892178946,0.801746254746566,0.412345909014352,0.789832148737863,0.848495497341204,0.550369445315533,0.493552064978465,1.13207629813724,1.07430507429502,0.663870203667597,1.44144016722456,1.1565278608485,0.478555639839023,1.01028988624211,0.559184207684815,1.60520290447811,1.23904481939615,1.85209363643263,1.78471927823025,1.24745640011415,0.79409193357975,1.46021069259086,0.589355774960957,0.439269090502263,1.47710443209659,0.974258571057893,0.728529333395789,0.725879797387857,1.28333861647756,1.44138233164122,1.16766634204392,0.393557919738859,1.12624773970973,0.564705516843438,0.874502465330913,1.87743118868458,0.859407954079518,0.676633954596541,0.872720292293068,0.855682391088225,0.701599610743518,0.846020437610686,0.841628840358887,0.850651712821331,0.418599422594088,0.354380598958724,0.499300622050354,0.589087068264094,1.11430680064268,1.36073278643818,0.734303379133138,0.889323433709718,1.11794424018676,0.652170424947829,0.921041464329516,0.781484789403536,1.42026961278448,0.821083520509457,0.890639830321202,0.954554927554727,0.583686398842205,0.343636888629344,0.581796606812127,0.676863772531559,0.906394572389273,1.2704594042498,0.571791338683789,0.512916917054216,0.436054618324855,1.13789505360507,0.721889505653048,1.64272735235182,0.84981026742533,0.864007458194982,1.34258438279761,0.654717098665082,1.27844051994076,0.447818368712752,0.574948930731983,0.737459807208557,0.919335751196955,0.822343918898444,0.538478886998891,0.589822783230786,0.75870952158866,0.498591066729791,1.0606531596879,0.492391180397991,0.509317442584959,0.673370652977297,0.64018206119913,1.3654590673065,0.470853578594633,0.716635913763198,0.837174268168667,0.955913448118947,0.371822239949182,2.08684320190823,0.506303591865036,2.13604813936431,1.31311524980393,0.419320186474978,0.886893027232331,0.605546861929041,1.30963642882444,1.15256969772279,0.434301805196179,1.64591533717731,0.638691672574809,0.505014631723092,0.262473535252419,0.94049650154118,0.675106978161247,1.21782897142555,0.700182680524862,0.664853243137592,0.587101638144844,0.501398521285417,0.759248206283657,0.500054739914905,1.85776671859044,0.68143864866397,0.610073082236941,0.594254345560745,0.526789210007948,0.918470972065135,0.73968772622432,1.39142544958875,0.358923129413187,0.712056851290871,0.644236114766654,1.40726580470396,1.21255481869874,1.3116349064755,0.634949466111079,0.448478573581936,0.487390617299625,0.769339679228816,1.06338890919473,0.812639326047194,1.11296523920243,0.840703385895877,0.705641533491977,0.611465704783518,0.581737658169724,0.603526022241722,0.862357710748254,0.958348557057413,1.3163135304675,0.915724209079856,0.367801213919878,1.15926271268421,0.854058305034442,0.640225039686266,0.772048616644769,0.87095740672012,0.955337637498954,0.669686498054031,0.5183656940579,0.335679274738792,0.595292521719871,0.777121947420291,0.49462988006041,0.597498680808121,1.67079839377068,0.771951052056438,0.983024070967159,0.584442087726714,0.763866730076408,0.927348754412815,1.17919940411688,1.49349955183523,0.613832754423471,0.684753076289995,0.339299536203049,0.660904152636188,1.06854690242498,2.15594847365653,1.03721999566465,0.855337450504901,0.471513931896044,0.941873555846823,0.586430847660306,0.843395054295481,0.560357849117875,0.536132568476371,0.291305248645274,0.910244564683287,1.41579847673176,0.785624064677735,0.778962117329908,0.505246563552766,0.788714161357792,1.36292179371646,0.945760031726689,1.45897052807989,0.894384156745656,0.368910406768687,0.750214644429953,1.94951281347411,1.39396660838255,0.825503303732082,0.813129203495166,0.331922484538278,0.516573142222779,1.03716263092246,1.15090107011866,0.186243620595391,0.783633149202914,0.445736526848666,0.949069244187603,0.526692687446904,0.75521907345653,0.447522641018907,0.902977957915088,0.423289992807237,0.373599207835885,1.11293631194934,1.12643102803622,0.548098457763912,0.423076362363236,1.31764319802256,0.960065993237713,1.20575794632029,0.516444605933532,0.367577854171277,0.613374033176223,0.795550494156393,1.13073841585446,0.606614386856728,0.461200930376538,0.441061665939964,0.671126092254748,0.846866658622331,0.798845260945997,0.662995267217235,0.329051575550819,0.821993961065206,0.698404873657815,1.17073119290937,1.26708648425125,0.630778542131079,0.725260626771153,0.659717124139409,1.99053918080027,0.771586206543561,0.780788308336769,0.603468246657916,0.683369570789821,1.13466108334562,0.496389672767192,0.517186770523246,1.09956594426487,0.810162028672195,0.640807601434241,0.203476138217921,0.240279663531857,1.70085597409513,0.183377258828667,0.641013507810265,1.02887954249192,0.435517012486829,0.74523496925397,0.858850946676955,1.05059985076789,0.416411267484397,0.997797320838582,0.799329293345889,0.64763713425051,1.02263805046022,2.38222421278314,0.357433791232886,1.13264769129989,1.9619862870055,0.348777256976429,0.706481492619379,0.801190415854527,0.521594215161824,0.452948984796072,0.600522756601724,0.341686942085813,1.18990297143337,0.394176712952456,0.370126389594655,1.08039808621771,0.322976925515624,0.422656607213336,0.791479106527482,1.03360545708855,1.27810491942256,0.376113423347493,0.325840287717653,0.865512788394165,0.876039915778386,0.658463683355553,1.40531690160791,0.317068199534214,0.498501796763045,0.437565909310729,0.647722543575653,1.45323103672932,0.688959584727926,0.460961968972598,0.880088504415402,0.275963336089019,0.332341951443139,0.444321526697873,0.621448665461281,0.506858053875687,0.527345966033732,0.833743563674065,0.406987999471696,0.303310744664148,1.7411521295833,0.923914790517093,1.5938181929761,0.504095366490004,0.438653332841746,0.704720487433409,0.944601891016873,0.783420698339721,1.37812252532079,0.279858426334464,0.490939649494857,0.630800285945664,0.53265536743623,0.42361491920357,2.18491862589218,0.1911897450425,0.69038541407153,0.904677523827536,2.1487004287043,0.809435309354605,0.649857185628965,0.291175130674786,0.266285954889354,0.955371823620121,0.546298253216618,0.551705437867516,0.965657438772583,0.758962082080332,0.458304661024485,0.281587636906856,0.748825084415019,2.46248165485981,0.41419338309815,0.398556497857624,0.413982998152759,0.643930812926865,0.463004808423456,0.541435202577678,0.347627310613768,0.455968459441865,0.282285258236855,0.212158371342789,0.289225847823179,0.485921381393113,1.1321772638938,0.379508265224036,0.243206533849136,0.893925881516548,0.332639787948045,0.461079514776866,0.365585624188737,0.56038109078734,0.438363893476854,0.763611042143051,1.27229533599608,0.367612694873778,0.445297584831837,0.348737747580304,0.349281858255618,0.577297732956962,0.901019891033917,0.249797650917494,0.527990386946918,0.384958535038572,1.05806943247038,0.392930705258955,0.331579337367571,0.615084951333094,0.317952029457657,1.60832702392326,0.306242970897161,0.868191347674365,0.440146641607138,0.270925628185681,0.256561441063534,0.164071628584961,0.370910807838449,0.85968673397325,0.63190799196117,0.366251139696041,0.267351145331658,1.26651653362406,0.323138275188609,0.501019864425885,1.86223869840707,0.959017922656504,0.303243248672141,1.35378276681945,2.30680566908966,0.403880510756145,0.562961201716878,0.505000033534175,0.259858204436236,0.412880999228848,0.631043873914011,0.253640216755496,0.800399578129284,0.29726179046473,0.48443106031701,1.4017130273262,0.402442470885937,0.462066808034963,1.8810478599276,1.89073573587656,0.19493543476874,0.277364272760522,0.551569662496557,0.227429757181816,0.36360883455556,0.632116336781979,0.463529794884163,0.345464746132192,0.230105139459504,0.354303676646352,0.394982105499142,0.254336881212103,0.376930546061367,0.33211324340109,0.36481970667388,0.303233272827348,0.310004880149086,0.492372567696037,0.24926863428041,0.574857487226163,0.366021993368565,1.9634080178188,0.666460811480225,0.391083771917399,0.209603881150056,1.43697992680475,0.397448635153448,2.40690641255849,0.55766311718264,0.197684912450886,0.341246368186558,0.436816087264433,1.46601264220806,1.01724974671991,10.7502124137064,0.373143801184095,1.40483699956598,0.762188731376498,0.481420983091914,0.554977570187218,0.269196484136657,0.796154012832634,0.72664762919848,0.666331054817845,0.480582008106953,0.541358540444353,0.586769579306342,0.874673600727152,2.12777665690464,0.242620926299328,0.681655329458842,1.288912189783,0.873213278072342,0.347658284862952,0.358887661958027,0.237539206596378,2.24355510987648,1.57285496864518,0.27332529525346,0.362953827161432,0.730101320275404,0.258179072600022,0.307726000358573,0.503699344108714,0.820725791615349,0.269443374234083,0.694413371127061,0.277458328398252,0.222263143878698,0.245376553714112,1.00501272433226,1.29238549826798,0.310433079645949,0.478028722008021,0.174344936713625,0.283014436144449,2.07515262798545,0.228900095477036,2.14082874049045,0.299561635754486,1.24257663419793,1.05915981571872,0.264369935533116,0.981722788480133,0.717067246034716,2.20788629286789,1.84936735190265,1.87086214257924,0.599591576905735,0.984591622694098,1.34333948888379,1.1915920813719,0.198645126958975,0.547592409154466,0.129880877875461,0.175028598760091,2.68352175870386,2.0260961147016,2.19289713155438,3.74389605195808,2.78609478084359,0.231816001677642,1.19227199810457,1.18512220061901,1.86872481128985,2.36977687083567,2.38635811962287,0.984893400620747,0.805812853004079,1.2067885322215,3.61410985821386,4.63707850396283,0.413124230635821,1.38675147180374,0.814583119730602,0.741768696259092,2.78153016314528,0.827562745722947,2.30667123246428]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>waldStat<\/th>\n      <th>df<\/th>\n      <th>pvalue<\/th>\n      <th>fcMedian<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":1,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 3, 3, \",\", \".\");\n  }"},{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render","options.columnDefs.2.render","options.columnDefs.3.render"],"jsHooks":[]}</script>

## detremine the number of candidate genes
patternGenes  [1] 577

## Assessing our results through visualization
plotSmoothers(slingshot_umap, counts(slingshot_umap), gene = c("Cntnap5a"))
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-24-2.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="far fa-chart-bar fa-stack-1x fa-inverse"></i> </span> <strong>Results &amp; interpretation:</strong></p>
<ul>
<li>We have 592 of 643 genes demonstrate differential gene expression patterns between lineages.</li>
<li>It is critical, like with any omics data study, to double-check our results using visualisation. For this question, we will visualise the change in the expression of the most important gene, <code>Cntnap5a</code>.</li>
</ul>
</div>
</div>
<div id="can-we-group-the-genes-in-terms-of-their-gene-expression-patterns-across-the-pseudotime" class="section level3">
<h3 class="hasAnchor">
<a href="#can-we-group-the-genes-in-terms-of-their-gene-expression-patterns-across-the-pseudotime" class="anchor"></a>4.3 Can we group the genes in terms of their gene expression patterns across the pseudotime?</h3>
<p>Hypothesis testing (‘patternTest’) generates a value describe the degree to which a gene’s expression as a function of pseudotime is distinct across lineages; however, it does not capture the diversity of pseudotime patterns among these genes. To this end, we can further cluster genes according to their expression pattern along the pseudotime for each lineage using the <code>clusterExpressionPattern</code> function from the <code>tradeSeq</code> package. The <em>resulting output</em> is a clustering label that denotes gene groups based on like gene expression profiles.</p>
<p><strong>Computation:</strong></p>
<p>The <em>main arguments</em> of the function are</p>
<pre><code>1) the slingshot output, 
2) `nPoints` which denotes the number of points along each lineage to cluster the genes, and 
3) the `genes` to use in the clustering. More details of the implementation can be found in [this vignette](https://statomics.github.io/tradeSeq/articles/tradeSeq.html).</code></pre>
<p>Note that the clustering uses the clusterExperiment package (Risso et al. 2018), hence the user may select any clustering algorithm that’s built into that package (check the output of <code><a href="https://rdrr.io/pkg/clusterExperiment/man/builtInClusteringFunctions.html">clusterExperiment::listBuiltInFunctions()</a></code> on the command line to see available methods). <code>clusterExpressionPatterns</code> take a few minutes to run in our case, you can load our prerun results instead.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">clusterExperiment</span><span class="op">)</span>
<span class="va">nPointsClus</span> <span class="op">&lt;-</span> <span class="fl">20</span>

<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"~/output/clusPat.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">clusPat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tradeSeq/man/clusterExpressionPatterns.html">clusterExpressionPatterns</a></span><span class="op">(</span><span class="va">slingshot_umap</span>, nPoints <span class="op">=</span> <span class="va">nPointsClus</span>,
                                       genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">patternRes</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">clusPat</span>, <span class="st">"~/output/clusPat.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">clusPat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/output/clusPat.rds"</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">clusterLabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterExperiment/man/ClusterExperiment-methods.html">primaryCluster</a></span><span class="op">(</span><span class="va">clusPat</span><span class="op">$</span><span class="va">rsec</span><span class="op">)</span>

<span class="va">cUniq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html">unique</a></span><span class="op">(</span><span class="va">clusterLabels</span><span class="op">)</span>
<span class="va">cUniq</span> <span class="op">&lt;-</span> <span class="va">cUniq</span><span class="op">[</span><span class="op">!</span><span class="va">cUniq</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="co"># remove unclustered genes</span></code></pre></div>
<p>The clustering results genreated from running the <code>clusterExpressionPatterns</code> function shows a total 52 clustering groups with 98 genes that have not been assigned to a cluster and may demonstrate unique gene expression patterns. We will also visualise the normalised expression patterns of genes from three clusters.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html">table</a></span><span class="op">(</span><span class="va">clusterLabels</span><span class="op">)</span>
<span class="co">#&gt; clusterLabels</span>
<span class="co">#&gt;  -1   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19 </span>
<span class="co">#&gt; 116  55  44  27  24  16  13  11  11  11  10  10  10   9   9   8   8   8   8   8 </span>
<span class="co">#&gt;  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39 </span>
<span class="co">#&gt;   8   7   7   7   7   7   7   7  13   7  13   6   6   6   6   6   6   6   6   6 </span>
<span class="co">#&gt;  40  41  42  43  44  45  46  47  48  49  50  51  52  53 </span>
<span class="co">#&gt;  12   6   6   6   6   6   6   5   5   5   5   5   5   5</span>

<span class="va">ggCluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">xx</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">cId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html">which</a></span><span class="op">(</span><span class="va">clusterLabels</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">[[</span><span class="va">xx</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nPointsClus</span>,
                                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">clusPat</span><span class="op">$</span><span class="va">yhatScaled</span><span class="op">[</span><span class="va">cId</span>, <span class="op">]</span><span class="op">)</span>,
                                        <span class="va">nPointsClus</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Cluster "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">[[</span><span class="va">xx</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,  x <span class="op">=</span> <span class="st">"Pseudotime"</span>, y <span class="op">=</span> <span class="st">"Normalized expression"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cId</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">geneId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">clusPat</span><span class="op">$</span><span class="va">yhatScaled</span><span class="op">)</span><span class="op">[</span><span class="va">cId</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span><span class="op">]</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nPointsClus</span>, <span class="fl">3</span><span class="op">)</span>,
                                  y <span class="op">=</span> <span class="va">clusPat</span><span class="op">$</span><span class="va">yhatScaled</span><span class="op">[</span><span class="va">geneId</span>, <span class="op">]</span>,
                                  lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="va">nPointsClus</span><span class="op">)</span><span class="op">)</span>,
                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">lineage</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">lineage</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">ggCluster</span><span class="op">[[</span><span class="va">xx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"darkseagreen3"</span>, <span class="st">"darkblue"</span><span class="op">)</span>,
                       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span>  
<span class="op">}</span>


<span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">ggCluster</span>, ncol <span class="op">=</span> <span class="fl">4</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<!-- Discussion -->
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong></p>
<ul>
<li><p>Can you describe the various expression patterns? Note that there are two layers of differences: genes show (1) differential expression across a pseudotime within a lineage <strong>and</strong> (2) these differential expression patterns are significantly different between lineages.</p></li>
<li><p>Would setting a greater number of <code>nPoints</code> (e.g., 40, 60, 80) change the clustering results?</p></li>
</ul>
</div>
</div>
<div id="what-is-the-functional-annotation-for-the-various-gene-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-the-functional-annotation-for-the-various-gene-sets" class="anchor"></a>4.4 What is the functional annotation for the various gene sets?</h3>
<p>To establish the functional annotation of the various clusters of genes obtained in Section 4.3, it is similar to identifying whether specific pathways or gene sets is enriched in these clusters of genes. Here, we perform gene set over-representation (GO) analysis and illustrate this analysis by identify gene ontology gene sets that are over-represented in cluster 2 (38 genes). The results is shown in a table.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clusterLabels</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">clusPat</span><span class="op">$</span><span class="va">yhatScaled</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">clusterProfiler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Mm.eg.db</span><span class="op">)</span>
<span class="va">eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html">bitr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clusterLabels</span><span class="op">)</span><span class="op">[</span><span class="va">clusterLabels</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span>,
           fromType <span class="op">=</span> <span class="st">"SYMBOL"</span>,
           toType <span class="op">=</span> <span class="st">"ENTREZID"</span>,
           OrgDb <span class="op">=</span> <span class="st">"org.Mm.eg.db"</span><span class="op">)</span>

<span class="va">geneList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html">bitr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span>,
                 fromType <span class="op">=</span> <span class="st">"SYMBOL"</span>, 
                 toType <span class="op">=</span> <span class="st">"ENTREZID"</span>, 
                 OrgDb <span class="op">=</span> <span class="st">"org.Mm.eg.db"</span><span class="op">)</span>

<span class="va">ego_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichGO.html">enrichGO</a></span><span class="op">(</span>gene <span class="op">=</span> <span class="va">eg</span><span class="op">$</span><span class="va">ENTREZID</span>,
                    universe <span class="op">=</span> <span class="va">geneList</span><span class="op">$</span><span class="va">ENTREZID</span>,
                    OrgDb <span class="op">=</span> <span class="va">org.Mm.eg.db</span>,
                    ont <span class="op">=</span> <span class="st">"BP"</span>,
                    pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,
                    minGSSize <span class="op">=</span> <span class="fl">20</span>,
                    maxGSSize <span class="op">=</span> <span class="fl">200</span>,
                    pvalueCutoff <span class="op">=</span> <span class="fl">1</span>,
                    qvalueCutoff <span class="op">=</span> <span class="fl">1</span>,
                    readable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co">## generate results</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ego_res</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                    ID                                             Description</span>
<span class="co">#&gt; GO:0006261 GO:0006261                           DNA-dependent DNA replication</span>
<span class="co">#&gt; GO:0006270 GO:0006270                              DNA replication initiation</span>
<span class="co">#&gt; GO:0033260 GO:0033260                                 nuclear DNA replication</span>
<span class="co">#&gt; GO:0044786 GO:0044786                              cell cycle DNA replication</span>
<span class="co">#&gt; GO:0000724 GO:0000724 double-strand break repair via homologous recombination</span>
<span class="co">#&gt; GO:0000725 GO:0000725                                  recombinational repair</span>
<span class="co">#&gt;            GeneRatio   BgRatio       pvalue     p.adjust       qvalue</span>
<span class="co">#&gt; GO:0006261      9/42 135/21696 4.000306e-12 3.328254e-09 2.505455e-09</span>
<span class="co">#&gt; GO:0006270      6/42  29/21696 1.665923e-11 5.766982e-09 4.341289e-09</span>
<span class="co">#&gt; GO:0033260      6/42  30/21696 2.079441e-11 5.766982e-09 4.341289e-09</span>
<span class="co">#&gt; GO:0044786      6/42  35/21696 5.644087e-11 1.173970e-08 8.837452e-09</span>
<span class="co">#&gt; GO:0000724      8/42 125/21696 9.695133e-11 1.433531e-08 1.079138e-08</span>
<span class="co">#&gt; GO:0000725      8/42 126/21696 1.033796e-10 1.433531e-08 1.079138e-08</span>
<span class="co">#&gt;                                                     geneID Count</span>
<span class="co">#&gt; GO:0006261 Mcm3/Dna2/Mcm4/Ccne2/Mms22l/Mcm2/Lig1/Mcm5/Cdt1     9</span>
<span class="co">#&gt; GO:0006270                  Mcm3/Mcm4/Ccne2/Mcm2/Mcm5/Cdt1     6</span>
<span class="co">#&gt; GO:0033260                   Mcm3/Dna2/Mcm4/Mcm2/Lig1/Cdt1     6</span>
<span class="co">#&gt; GO:0044786                   Mcm3/Dna2/Mcm4/Mcm2/Lig1/Cdt1     6</span>
<span class="co">#&gt; GO:0000724      Mcm3/Mcm4/Rmi2/Mms22l/Rpa2/Mcm2/Gins2/Mcm5     8</span>
<span class="co">#&gt; GO:0000725      Mcm3/Mcm4/Rmi2/Mms22l/Rpa2/Mcm2/Gins2/Mcm5     8</span></code></pre></div>
<p><strong>Visualization:</strong> The <code><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html">clusterProfiler::dotplot</a></code> function can be used to visualise the results for the top significant pathways as a dot plot where the size of the circle represents the number of genes identified for the pathway of interest and the color of the function denotes the level of significance.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/enrichplot/man/dotplot.html">dotplot</a></span><span class="op">(</span><span class="va">ego_res</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="aimbox">
<p><span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <span class="far fa-comment fa-stack-1x fa-inverse"></span> </span> <strong>Discussion:</strong> + What are the top enriched pathways from the gene set over-representation analysis? + Are the results in line with what you expect?</p>
</div>
</div>
<div id="optional-which-gene-pair-correlations-change-across-lineages" class="section level3">
<h3 class="hasAnchor">
<a href="#optional-which-gene-pair-correlations-change-across-lineages" class="anchor"></a>4.5 [Optional] Which gene-pair correlations change across lineages?</h3>
<p>In the previous four questions, the focus is to identify a candidate gene interest. Here we aim to identify candidate “gene-pair”. This is achieve using an algorithm called <code>scHOT</code> <a href="https://www.nature.com/articles/s41592-020-0885-x">Ghzanfar et al., 2020</a>, where we can further test the change in gene expression of <strong>a pair of genes</strong> across a pseudotime. In the R package, there are two statistical higher order testing we can perform, controlled by the <code>higherOrderFunction</code> argument in <code>scHOT</code>. We can test for <strong>differential variability</strong> or <strong>differential correlation</strong> between pairs of genes across the pseudotime. 1) variability: <code>higherOrderFunction = matrixStats::weightedVar</code> 2) correlation: <code>higherOrderFunction = matrixStats::weightedSpearman</code></p>
<p><strong>Computation:</strong> To reduce computation time, we will select the top 10 genes identified from <code>associationTest</code> in 4.1. Using the top 10 genes, we generate a total of 45 gene pairs to test.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">scHOT</span><span class="op">)</span>

<span class="va">first_branch_cells</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">$</span><span class="va">slingPseudotime_1</span><span class="op">)</span>
<span class="va">assoRes_lingeag1_top10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">assoRes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">assoRes</span><span class="op">$</span><span class="va">waldStat_1</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="va">gene_to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="va">assoRes_lingeag1_top10</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><strong>Questions:</strong> To identify gene pairs that are differential correlated across the pseudotime for each lineage and visualise the results of the top 5 significant gene pairs that demonstrate differential correlation across our pseudotime.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"~/output/scHOT_obj.rds"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">scHOT_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scHOT/man/scHOT_buildFromMatrix.html">scHOT_buildFromMatrix</a></span><span class="op">(</span>
    mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html">logcounts</a></span><span class="op">(</span><span class="va">slingshot_umap</span><span class="op">)</span><span class="op">[</span>,<span class="va">first_branch_cells</span><span class="op">]</span>,
    cellData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pseudotime <span class="op">=</span> <span class="va">slingshot_umap</span><span class="op">$</span><span class="va">slingPseudotime_1</span><span class="op">[</span><span class="va">first_branch_cells</span><span class="op">]</span><span class="op">)</span>,
    positionType <span class="op">=</span> <span class="st">"trajectory"</span>,
    positionColData <span class="op">=</span> <span class="st">"pseudotime"</span><span class="op">)</span>
  <span class="va">scHOT_obj</span>
  
  <span class="va">scHOT_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scHOT/man/scHOT.html">scHOT</a></span><span class="op">(</span><span class="va">scHOT_obj</span>,
                     testingScaffold <span class="op">=</span> <span class="va">gene_to_test</span>,
                     nrow.out <span class="op">=</span> <span class="fl">100</span>, <span class="co"># The number of weightings to include for testing, a smaller value is faster for computation</span>
                     higherOrderFunction <span class="op">=</span> <span class="va">weightedSpearman</span>,
                     higherOrderFunctionType <span class="op">=</span> <span class="st">"weighted"</span>,
                     numberPermutations <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
  
  <span class="va">scHOT_obj</span><span class="op">@</span><span class="va">scHOT_output</span> <span class="op">&lt;-</span> <span class="va">scHOT_obj</span><span class="op">@</span><span class="va">scHOT_output</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">scHOT_obj</span><span class="op">@</span><span class="va">scHOT_output</span><span class="op">$</span><span class="va">FDREstimated</span><span class="op">)</span>,<span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">scHOT_obj</span>, file <span class="op">=</span> <span class="st">"~/output/scHOT_obj.rds"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">scHOT_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"~/output/scHOT_obj.rds"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/scHOT/man/plotHigherOrderSequence.html">plotHigherOrderSequence</a></span><span class="op">(</span><span class="va">scHOT_obj</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">rownames</a></span><span class="op">(</span><span class="va">scHOT_obj</span><span class="op">@</span><span class="va">scHOT_output</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
</div>
<div id="cell-cell-communication-optional" class="section level2">
<h2 class="hasAnchor">
<a href="#cell-cell-communication-optional" class="anchor"></a>5. Cell-cell communication [Optional]</h2>
<p>Cellular communication is the essential process that enables multicellular life to exist. It is mediated by complex molecular connections, which are frequently referred to as networks. These control the way organisms respond to changes in their internal state and their external environment. In this section, the term “cell-cell communication” refers to the degree to which ligand-receptor pairs co-express each other. We will examine the cell-cell communication using the package <a href="https://www.nature.com/articles/s41467-021-21246-9">CellChat</a>.</p>
<div id="estimate-cellular-communication" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-cellular-communication" class="anchor"></a>5.1 Estimate cellular communication</h3>
<p>CellChat requires gene expression data of cells and the cell type grouping information as the user input and models the probability of cell-cell communication by integrating gene expression with prior knowledge of the interactions between signaling ligands, receptors and their cofactors. The following illustrate the four steps appraoch for estimating <code>cell-cell interaction</code> or <code>cell-cell communication</code>.</p>
<p><strong>Step 1 - Input gene expression data:</strong> We will use the normalised data and set the <code>ClusterName</code> as the cell type label.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">CellChat</span><span class="op">)</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/createCellChat.html">createCellChat</a></span><span class="op">(</span>object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/assays.html">logcounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span>, 
                           meta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span>, 
                           group.by <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span>
<span class="co">#&gt; The cell groups used for CellChat analysis are  CA CA1-Sub CA2-3-4 Granule ImmGranule1 ImmGranule2 Nbl1 Nbl2</span>

<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/setIdent.html">setIdent</a></span><span class="op">(</span><span class="va">cellchat</span>, ident.use <span class="op">=</span> <span class="st">"ClusterName"</span><span class="op">)</span> <span class="co"># set "labels" as default cell identity</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">@</span><span class="va">idents</span><span class="op">)</span> <span class="co"># show factor levels of the cell labels</span>
<span class="co">#&gt; [1] "CA"          "CA1-Sub"     "CA2-3-4"     "Granule"     "ImmGranule1"</span>
<span class="co">#&gt; [6] "ImmGranule2" "Nbl1"        "Nbl2"</span></code></pre></div>
<p><strong>Step 2 - Input ligand-receptor interaction database:</strong> We will need to set ligand-receptor interaction database. Since this is a mouse data, we will use <code>CellChatDB.mouse</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cellchat</span><span class="op">@</span><span class="va">DB</span> <span class="op">&lt;-</span> <span class="va">CellChatDB.mouse</span> <span class="co"># Set CellChat Database</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/subsetData.html">subsetData</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span>
<span class="co">#&gt; Issue identified!! Please check the official Gene Symbol of the following genes:  </span>
<span class="co">#&gt;  H2-Q8 H2-T9 H2-T18 H2-Q9 H2-L H2-BI H2-D H60a H2-Ea-ps</span></code></pre></div>
<p><strong>Step 3 - Identify over expressed interaction:</strong> We will use <code>identifyOverExpressedGenes</code> and <code>identifyOverExpressedInteractions</code> to identify over-expressed ligands or receptors in one cell group and then identify over-expressed ligand-receptor interactions if either ligand or receptor is over-expressed.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/identifyOverExpressedGenes.html">identifyOverExpressedGenes</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/identifyOverExpressedInteractions.html">identifyOverExpressedInteractions</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span></code></pre></div>
<p><strong>Step 4 - Compute communication probability:</strong> We can now compute the the communication probability and infer cellular communication network at both ligand-receptor pair level (<code>computeCommunProb</code>) and pathway level (<code>computeCommunProbPathway</code>). CellChat infers the biologically significant cell-cell communication by assigning each interaction with a probability value and peforming a permutation test.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Compute the communication probability and infer cellular communication network</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/computeCommunProb.html">computeCommunProb</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span>
<span class="co"># Filter out the cell-cell communication if there are only few number of cells in certain cell groups</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/filterCommunication.html">filterCommunication</a></span><span class="op">(</span><span class="va">cellchat</span>, min.cells <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#Infer the cell-cell communication at a signaling pathway level</span>
<span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/computeCommunProbPathway.html">computeCommunProbPathway</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span></code></pre></div>
</div>
<div id="initial-data-analysis-of-cell-cell-communication-ccc-and-visualization" class="section level3 tabset tabset-fade tabset-pills">
<h3 class="hasAnchor">
<a href="#initial-data-analysis-of-cell-cell-communication-ccc-and-visualization" class="anchor"></a>5.2 Initial data analysis of cell-cell communication (CCC) and visualization</h3>
<p>We can now begin doing initial data analysis or descriptive analysis of the cell-cell communication outcomes using the computed cell-cell communication probabilities. To describe the relationship between various cell types, we can first calculate and visualise the aggregated cell-cell com network by counting the number of links or summarizing the communication probability to create a cell-type interaction network.</p>
<div id="a-cell-type-communication-network" class="section level4">
<h4 class="hasAnchor">
<a href="#a-cell-type-communication-network" class="anchor"></a>(a) Cell-type communication network</h4>
<p>The plot below illustrate the cell-type communication network, with each node representing a cell type and its size proportional to the number of cell types in the data; each edge reflects the number of interactions or the weights of interactions between two cell types.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cellchat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/aggregateNet.html">aggregateNet</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">)</span>

<span class="co">## Network graph</span>
<span class="va">groupSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html">table</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">@</span><span class="va">idents</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/netVisual_circle.html">netVisual_circle</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">@</span><span class="va">net</span><span class="op">$</span><span class="va">count</span>, vertex.weight <span class="op">=</span> <span class="va">groupSize</span>, weight.scale <span class="op">=</span> <span class="cn">T</span>, label.edge<span class="op">=</span> <span class="cn">F</span>, title.name <span class="op">=</span> <span class="st">"Number of interactions"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/netVisual_circle.html">netVisual_circle</a></span><span class="op">(</span><span class="va">cellchat</span><span class="op">@</span><span class="va">net</span><span class="op">$</span><span class="va">weight</span>, vertex.weight <span class="op">=</span> <span class="va">groupSize</span>, weight.scale <span class="op">=</span> <span class="cn">T</span>, label.edge<span class="op">=</span> <span class="cn">F</span>, title.name <span class="op">=</span> <span class="st">"Interaction weights/strength"</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div id="b-cell-type-communication-for-a-given-pathway" class="section level4">
<h4 class="hasAnchor">
<a href="#b-cell-type-communication-for-a-given-pathway" class="anchor"></a>(b) Cell-type communication for a given pathway</h4>
<p>We can zoom into a certain signalling pathway and examine the communication level of this pathway between any pairs of cell types. We will use the ‘NCAM’ pathway as an illustration, and the figure below demonstrates that the NCAM pathway is highly involved (high communication probability) in communication between CA, ImmGranule, and Granule cell types, but is less involved in communication involving Nbl.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pathways.show</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NCAM"</span><span class="op">)</span> 
<span class="co"># Here we define `vertex.receive` so that the left portion of the hierarchy plot shows signaling to fibroblast and the right portion shows signaling to immune cells </span>
<span class="va">vertex.receiver</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span> <span class="co"># a numeric vector. </span>
<span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/netVisual_aggregate.html">netVisual_aggregate</a></span><span class="op">(</span><span class="va">cellchat</span>, signaling <span class="op">=</span> <span class="va">pathways.show</span>,  vertex.receiver <span class="op">=</span> <span class="va">vertex.receiver</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/netVisual_heatmap.html">netVisual_heatmap</a></span><span class="op">(</span><span class="va">cellchat</span>, signaling <span class="op">=</span> <span class="va">pathways.show</span>, color.heatmap <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-36-2.png" width="700"></p>
</div>
<div id="c-cell-cell-communication-with-bubble-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#c-cell-cell-communication-with-bubble-plot" class="anchor"></a>(c) Cell-cell communication with bubble plot</h4>
<p>We can visualise the all the significant cell-cell communication of multiple ligand receptor pairs using <code>netVisual_bubble</code>, from <code>CA</code> (indicated by <code>source.use = 1</code>) to all other cell types (indicated by <code>targets.use = 2:7</code>). The y-axis indicates the ligand -&gt; receptor pair and the x-axis indicates the sender -&gt; receiver cell type pair. We can see that Nrxn1 - Nlgn1 pair is one of the ligands with high communication probability from cell type <code>CA</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/CellChat/man/netVisual_bubble.html">netVisual_bubble</a></span><span class="op">(</span><span class="va">cellchat</span>, sources.use <span class="op">=</span> <span class="fl">1</span>, targets.use <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, remove.isolate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_phenotyping_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
</div>
</div>
</div>
<div id="reference-and-other-useful-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-and-other-useful-resources" class="anchor"></a>Reference and other useful resources:</h2>
<ul>
<li>dynverse, a collection of R packages aimed at supporting the trajectory inference: <a href="https://dynverse.org" class="uri">https://dynverse.org</a>
</li>
<li>RNA velocity: <a href="http://velocyto.org" class="uri">http://velocyto.org</a>
</li>
<li>CellChat: <a href="https://github.com/sqjin/CellChat" class="uri">https://github.com/sqjin/CellChat</a>
</li>
</ul>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><a href="mailto:yinxin.lin@sydney.edu.au" class="email">yinxin.lin@sydney.edu.au</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="mailto:hani.kim@sydney.edu.au" class="email">hani.kim@sydney.edu.au</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="mailto:cchen@uni.sydney.edu.au" class="email">cchen@uni.sydney.edu.au</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sydney Precision Bioinformatics Alliance.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
